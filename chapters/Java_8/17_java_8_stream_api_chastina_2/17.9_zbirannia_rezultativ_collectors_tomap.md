---
layout: default
title: "–ó–±–∏—Ä–∞–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤: Collectors.toMap()"
parent: "Stream API"
grand_parent: "Java 8"
nav_order: 9
---

# –ó–±–∏—Ä–∞–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤: Collectors.toMap()

* –∫–æ—Ä–æ—Ç–∫–∏–π –æ–ø–∏—Å: `Collectors.toMap()` ‚Äì —Ü–µ –∫–æ–ª–µ–∫—Ç–æ—Ä, —â–æ –¥–æ–∑–≤–æ–ª—è—î –∑—ñ–±—Ä–∞—Ç–∏ –µ–ª–µ–º–µ–Ω—Ç–∏ —Å—Ç—Ä—ñ–º—É —É `Map<K, V>`, –≤–∫–∞–∑—É—é—á–∏, —è–∫ —Ñ–æ—Ä–º—É–≤–∞—Ç–∏ –∫–ª—é—á—ñ —Ç–∞ –∑–Ω–∞—á–µ–Ω–Ω—è. –ú–∞—î –ø–µ—Ä–µ–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–ª—è –æ–±—Ä–æ–±–∫–∏ –¥—É–±–ª—é—é—á–∏—Ö –∫–ª—é—á—ñ–≤ (`mergeFunction`) —Ç–∞ –¥–ª—è –≤–∫–∞–∑–∞–Ω–Ω—è —Ç–∏–ø—É `Map` (`mapSupplier`).

* –ø–æ–Ω—è—Ç—Ç—è: `Collectors.toMap()`, `keyMapper`, `valueMapper`, `mergeFunction` (–¥–ª—è –¥—É–±–ª—ñ–∫–∞—Ç—ñ–≤), `mapSupplier` (–¥–ª—è —Ç–∏–ø—É `Map`).

* –ø—Ä–∏–∫–ª–∞–¥–∏: `names.stream().collect(Collectors.toMap(name -> name, name -> name.length()))`, `names.stream().collect(Collectors.toMap(name -> name, name -> 1, Integer::sum))` (–æ–±—Ä–æ–±–∫–∞ –¥—É–±–ª—ñ–∫–∞—Ç—ñ–≤).

* –∫–ª—é—á–æ–≤—ñ –º–æ–º–µ–Ω—Ç–∏: –û–±–æ–≤'—è–∑–∫–æ–≤–æ –æ–±—Ä–æ–±–ª—è—Ç–∏ –¥—É–±–ª—ñ–∫–∞—Ç–∏ –∫–ª—é—á—ñ–≤, —è–∫—â–æ –≤–æ–Ω–∏ –º–æ–∂—É—Ç—å –≤–∏–Ω–∏–∫–Ω—É—Ç–∏, —ñ–Ω–∞–∫—à–µ ‚Äì `IllegalStateException`.

* —â–æ –≤–∞–∂–ª–∏–≤–æ –∑–Ω–∞—Ç–∏ –Ω–∞ —Å–ø—ñ–≤–±–µ—Å—ñ–¥—ñ: –Ø–∫ –∑—ñ–±—Ä–∞—Ç–∏ —É `Map`, –æ–±—Ä–æ–±–∫–∞ –¥—É–±–ª—ñ–∫–∞—Ç—ñ–≤.

### **‚úÖ –û—Ñ—ñ—Ü—ñ–π–Ω–µ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è:**

**`Collectors.toMap()`** ‚Äî –º–µ—Ç–æ–¥ –∫–æ–ª–µ–∫—Ç–æ—Ä–∞ –∑ –ø–∞–∫–µ—Ç—É **`java.util.stream.Collectors`**, —è–∫–∏–π –¥–æ–∑–≤–æ–ª—è—î –∑—ñ–±—Ä–∞—Ç–∏ –µ–ª–µ–º–µ–Ω—Ç–∏ —Å—Ç—Ä—ñ–º—É —É **`Map<K, V>`**, –≤–∫–∞–∑—É—é—á–∏ —è–∫ —Å–∞–º–µ —Ñ–æ—Ä–º—É–≤–∞—Ç–∏ –∫–ª—é—á—ñ —Ç–∞ –∑–Ω–∞—á–µ–Ω–Ω—è.

### **üß† –ü—Ä–æ—Å—Ç–∏–º–∏ —Å–ª–æ–≤–∞–º–∏:**

–¶–µ —è–∫ ‚Äú–ø–µ—Ä–µ—Ç–≤–æ—Ä–∏—Ç–∏ —Å–ø–∏—Å–æ–∫ –≤ –º–∞–ø—É‚Äù, —Å–∫–∞–∑–∞–≤—à–∏: ¬´–û—Ü–µ–π –µ–ª–µ–º–µ–Ω—Ç –±—É–¥–µ –∫–ª—é—á–µ–º, –∞ –æ—Ü–µ–π ‚Äî –∑–Ω–∞—á–µ–Ω–Ω—è–º¬ª. –ê–ª–µ —Ç—Ä–µ–±–∞ –±—É—Ç–∏ –æ–±–µ—Ä–µ–∂–Ω–∏–º —ñ–∑ –¥—É–±–ª—è–º–∏ –∫–ª—é—á—ñ–≤ ‚Äî Java –Ω–µ –ø—Ä–æ–±–∞—á–∞—î –¥–≤–æ—Ö –æ–¥–Ω–∞–∫–æ–≤–∏—Ö –∫–ª—é—á—ñ–≤ –±–µ–∑ –ø–æ—è—Å–Ω–µ–Ω—å

---

## üìä **–°–∏–≥–Ω–∞—Ç—É—Ä–∏ toMap():**

```java
// –ë–∞–∑–æ–≤–∞ –≤–µ—Ä—Å—ñ—è
toMap(Function keyMapper, Function valueMapper)

// –ó –æ–±—Ä–æ–±–∫–æ—é –∫–æ–Ω—Ñ–ª—ñ–∫—Ç—ñ–≤ –∫–ª—é—á—ñ–≤
toMap(Function keyMapper, Function valueMapper, BinaryOperator mergeFunction)

// –ó –≤–∫–∞–∑–∞–Ω–Ω—è–º —Ç–∏–ø—É Map
toMap(Function keyMapper, Function valueMapper, BinaryOperator mergeFunction, Supplier mapSupplier)
```

üìå **–ê—Ä–≥—É–º–µ–Ω—Ç–∏:**

* **`keyMapper`** ‚Äî —è–∫ –æ—Ç—Ä–∏–º–∞—Ç–∏ –∫–ª—é—á –∑ –µ–ª–µ–º–µ–Ω—Ç–∞
* **`valueMapper`** ‚Äî —è–∫ –æ—Ç—Ä–∏–º–∞—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è
* **`mergeFunction`** ‚Äî —â–æ —Ä–æ–±–∏—Ç–∏, —è–∫—â–æ –¥–≤–∞ –æ–¥–Ω–∞–∫–æ–≤–∏—Ö –∫–ª—é—á—ñ
* **`mapSupplier`** ‚Äî —è–∫—É —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—é Map —Å—Ç–≤–æ—Ä–∏—Ç–∏ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, **`TreeMap`**)

---

## **–ü–æ—è—Å–Ω–µ–Ω–Ω—è –Ω–∞ –ø–∞–ª—å—Ü—è—Ö (üí°)**

–£—è–≤–∏: –≤ —Ç–µ–±–µ —Å–ø–∏—Å–æ–∫ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤, —ñ —Ç–∏ —Ö–æ—á–µ—à —Å—Ç–≤–æ—Ä–∏—Ç–∏ –º–∞–ø—É **`—ñ–º‚Äô—è --> –æ—Ü—ñ–Ω–∫–∞`**.

–ê–ª–µ —è–∫—â–æ –¥–≤–∞ "–ê–Ω–¥—Ä—ñ—ó" –æ—Ç—Ä–∏–º–∞–ª–∏ —Ä—ñ–∑–Ω—ñ –±–∞–ª–∏ ‚Äî —â–æ —Ä–æ–±–∏—Ç–∏? –û—Ç —Ç—É—Ç —ñ –ø–æ—Ç—Ä—ñ–±–Ω–∞ merge-—Ñ—É–Ω–∫—Ü—ñ—è:

‚úîÔ∏è —á–∏ –±—Ä–∞—Ç–∏ –ø–µ—Ä—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç,

‚úîÔ∏è —á–∏ —Å—É–º—É–≤–∞—Ç–∏,

‚úîÔ∏è —á–∏ –±—Ä–∞—Ç–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–π

---

## **–ö–æ—Ä–∏—Å–Ω—ñ –ø—Ä–∏–∫–ª–∞–¥–∏ (üß™)**

```java
// üìå –ü—Ä–æ—Å—Ç–µ –∑–±–∏—Ä–∞–Ω–Ω—è: —Å–ø–∏—Å–æ–∫ —ñ–º–µ–Ω --> –¥–æ–≤–∂–∏–Ω–∞ —ñ–º–µ–Ω—ñ
List<String> names = List.of("Anna", "Bob", "Alice");

Map<String, Integer> nameLengthMap = names.stream()
    .collect(Collectors.toMap(
        name -> name,              // keyMapper
        name -> name.length()      // valueMapper
    ));
```

```java
// ‚ö†Ô∏è –û–±—Ä–æ–±–∫–∞ –¥—É–±–ª—ñ–≤ –∫–ª—é—á—ñ–≤
List<String> names = List.of("Anna", "Bob", "Anna");

Map<String, Integer> nameCountMap = names.stream()
    .collect(Collectors.toMap(
        name -> name,
        name -> 1,
        Integer::sum               // mergeFunction: —Å—É–º—É—î–º–æ –ø–æ–≤—Ç–æ—Ä–∏
    ));
```

```java
// üå≤ –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è TreeMap
Map<String, Integer> sortedMap = names.stream()
    .collect(Collectors.toMap(
        name -> name,
        name -> name.length(),
        (a, b) -> b,               // –¥—É–±–ª—ñ–∫–∞—Ç–∏: –±–µ—Ä–µ–º–æ –æ—Å—Ç–∞–Ω–Ω—ñ–π
        TreeMap::new               // —Ç–∏–ø –º–∞–ø–∏
    ));
```

---

## **–ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è (‚öñÔ∏è)**

|           –í–∏–ø–∞–¥–æ–∫            |                –©–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑—Ä–æ–±–∏—Ç–∏                |
|:----------------------------:|:-------------------------------------------------:|
|     **–£–Ω—ñ–∫–∞–ª—å–Ω—ñ –∫–ª—é—á—ñ**      |   –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π –ø—Ä–æ—Å—Ç—É –≤–µ—Ä—Å—ñ—é **`toMap(k, v)`**    |
| **–ú–æ–∂–ª–∏–≤—ñ –¥—É–±–ª—ñ–∫–∞—Ç–∏ –∫–ª—é—á—ñ–≤** |             –î–æ–¥–∞–π **`mergeFunction`**             |
| **–ü–æ—Ç—Ä—ñ–±–Ω–∞ —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–∞ Map**  | –î–æ–¥–∞–π **`mapSupplier`**, –Ω–∞–ø—Ä. **`TreeMap::new`** |

---

## **üß† –ú–Ω–µ–º–æ–Ω—ñ–∫–∞ –¥–ª—è –∑–∞–ø–∞–º‚Äô—è—Ç–æ–≤—É–≤–∞–Ω–Ω—è:**

**"toMap \= tell me how to get the Key, Value, Maybe Merge, Maybe Map"**  

### –ó–∞–ø–∞–º‚Äô—è—Ç–∞–π 2+2 –≤–∞—Ä—ñ–∞–Ω—Ç–∏

* **`toMap(k, v)`**
* **`toMap(k, v, merge)`**
* **`toMap(k, v, merge, mapSupplier)`**

---

## **üü© –ü—ñ–¥—Å—É–º–æ–∫:**

* **`Collectors.toMap()`** –¥–æ–∑–≤–æ–ª—è—î –∑—ñ–±—Ä–∞—Ç–∏ —Å—Ç—Ä—ñ–º —É Map.
* –û–±–æ–≤‚Äô—è–∑–∫–æ–≤–æ –≤—Ä–∞—Ö–æ–≤—É–π –¥—É–±–ª—ñ–∫–∞—Ç–∏ –∫–ª—é—á—ñ–≤ ‚Äî –∞–±–æ —É–Ω–∏–∫–∞—Ç–∏ —ó—Ö, –∞–±–æ –æ–±—Ä–æ–±–ª—è—Ç–∏ **`mergeFunction`**.
* –ó–∞ –ø–æ—Ç—Ä–µ–±–∏ –º–æ–∂–Ω–∞ —è–≤–Ω–æ –≤–∫–∞–∑–∞—Ç–∏ —Ç–∏–ø –º–∞–ø–∏ (**`TreeMap`**, **`LinkedHashMap`**).
* –ü–æ—Ç—É–∂–Ω–∏–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ—ó —Å–ø–∏—Å–∫—ñ–≤ —É —Å–ª–æ–≤–Ω–∏–∫–∏ / –∞—Å–æ—Ü—ñ–∞—Ç–∏–≤–Ω—ñ –º–∞—Å–∏–≤–∏.

---

### **üîó –î–æ–¥–∞—Ç–∫–æ–≤—ñ –¥–∂–µ—Ä–µ–ª–∞:**

* [**Oracle JavaDoc: Collectors.toMap**](https://docs.oracle.com/javase/8/docs/api/java/util/stream/Collectors.html#toMap-java.util.function.Function-java.util.function.Function-)

* * *

# **FAQ ‚Äî –ß–∞—Å—Ç—ñ –∑–∞–ø–∏—Ç–∞–Ω–Ω—è (‚ùì)**

### **1 ‚ùì –ü–∏—Ç–∞–Ω–Ω—è:**

–©–æ —Ç–∞–∫–µ `Collectors.toMap()` —ñ –¥–ª—è —á–æ–≥–æ –≤—ñ–Ω –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è?

> #### **üí¨ –í—ñ–¥–ø–æ–≤—ñ–¥—å:**
>
> **`Collectors.toMap()`** ‚Äî —Ü–µ —Å—Ç–∞—Ç–∏—á–Ω–∏–π –º–µ—Ç–æ–¥-—Ñ–∞–±—Ä–∏–∫–∞ –∑ –∫–ª–∞—Å—É `java.util.stream.Collectors`, —è–∫–∏–π –ø–æ–≤–µ—Ä—Ç–∞—î `Collector`. –¶–µ–π –∫–æ–ª–µ–∫—Ç–æ—Ä –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è **–∑–±–∏—Ä–∞–Ω–Ω—è –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ –ø–æ—Ç–æ–∫—É (`Stream`) —É –º–∞–ø—É (`Map<K, V>`)**.
>
> **–û—Å–Ω–æ–≤–Ω–µ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è:** –ü–µ—Ä–µ—Ç–≤–æ—Ä–∏—Ç–∏ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å –¥–∞–Ω–∏—Ö –Ω–∞ –∞—Å–æ—Ü—ñ–∞—Ç–∏–≤–Ω—É —Å—Ç—Ä—É–∫—Ç—É—Ä—É "–∫–ª—é—á-–∑–Ω–∞—á–µ–Ω–Ω—è".
>
> –£ –Ω–∞–π–ø—Ä–æ—Å—Ç—ñ—à—ñ–π —Ñ–æ—Ä–º—ñ –≤—ñ–Ω –ø—Ä–∏–π–º–∞—î –¥–≤–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–∏:
>
> 1. **`keyMapper`**: `Function`, —è–∫–∞ –≤–∏–∑–Ω–∞—á–∞—î, —è–∫ –∑ –µ–ª–µ–º–µ–Ω—Ç–∞ –ø–æ—Ç–æ–∫—É –æ—Ç—Ä–∏–º–∞—Ç–∏ **–∫–ª—é—á** –¥–ª—è –º–∞–ø–∏.
> 2. **`valueMapper`**: `Function`, —è–∫–∞ –≤–∏–∑–Ω–∞—á–∞—î, —è–∫ –∑ –µ–ª–µ–º–µ–Ω—Ç–∞ –ø–æ—Ç–æ–∫—É –æ—Ç—Ä–∏–º–∞—Ç–∏ **–∑–Ω–∞—á–µ–Ω–Ω—è** –¥–ª—è –º–∞–ø–∏.
>
> –¶–µ –æ–¥–∏–Ω –∑ –Ω–∞–π–ø–æ—à–∏—Ä–µ–Ω—ñ—à–∏—Ö —ñ –Ω–∞–π–≤–∞–∂–ª–∏–≤—ñ—à–∏—Ö –∫–æ–ª–µ–∫—Ç–æ—Ä—ñ–≤ —É Stream API.

#### **üìù –ê–Ω–∞–ª–æ–≥—ñ—è:**

`Collectors.toMap()` ‚Äî —Ü–µ —è–∫ —Å–æ—Ä—Ç—É–≤–∞–ª—å–Ω–∏–π –∞–ø–∞—Ä–∞—Ç, —è–∫–∏–π –±–µ—Ä–µ –∫—É–ø—É —Ä–µ—á–µ–π (–µ–ª–µ–º–µ–Ω—Ç–∏ –ø–æ—Ç–æ–∫—É) —ñ —Ä–æ–∑–∫–ª–∞–¥–∞—î —ó—Ö –ø–æ –ø—ñ–¥–ø–∏—Å–∞–Ω–∏—Ö —è—â–∏–∫–∞—Ö. `keyMapper` ‚Äî —Ü–µ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è, —è–∫ –ø—ñ–¥–ø–∏—Å–∞—Ç–∏ —è—â–∏–∫ (—Å—Ç–≤–æ—Ä–∏—Ç–∏ –∫–ª—é—á), –∞ `valueMapper` ‚Äî —â–æ —Å–∞–º–µ –ø–æ–∫–ª–∞—Å—Ç–∏ –≤ —Ü–µ–π —è—â–∏–∫ (—Å—Ç–≤–æ—Ä–∏—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è).

#### **üìå –©–æ –ø–µ—Ä–µ–≤—ñ—Ä—è—é—Ç—å:**

*–ë–∞–∑–æ–≤–µ —Ä–æ–∑—É–º—ñ–Ω–Ω—è —Ç–æ–≥–æ, —è–∫ –∑–±–∏—Ä–∞—Ç–∏ –¥–∞–Ω—ñ –∑ –ø–æ—Ç–æ–∫—É –≤ –º–∞–ø—É. –¶–µ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–∞ –Ω–∞–≤–∏—á–∫–∞ –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ –¥–∞–Ω–∏–º–∏ –≤ Java.*

* * *

### **2 ‚ùì –ü–∏—Ç–∞–Ω–Ω—è:**

–ù–∞–≤–µ–¥—ñ—Ç—å –ø—Ä–∏–∫–ª–∞–¥ –Ω–∞–π–ø—Ä–æ—Å—Ç—ñ—à–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è `Collectors.toMap()`.

> #### **üí¨ –í—ñ–¥–ø–æ–≤—ñ–¥—å:**
>
> **–ó–∞–¥–∞—á–∞:** –ü–µ—Ä–µ—Ç–≤–æ—Ä–∏—Ç–∏ —Å–ø–∏—Å–æ–∫ —Ä—è–¥–∫—ñ–≤ (`List<String>`) –Ω–∞ –º–∞–ø—É, –¥–µ –∫–ª—é—á ‚Äî —Ü–µ —Å–∞–º —Ä—è–¥–æ–∫, –∞ –∑–Ω–∞—á–µ–Ω–Ω—è ‚Äî –π–æ–≥–æ –¥–æ–≤–∂–∏–Ω–∞ (`Map<String, Integer>`).
>
> **–†—ñ—à–µ–Ω–Ω—è:**
>
> 1. –°—Ç–≤–æ—Ä—é—î–º–æ –ø–æ—Ç—ñ–∫ –∑—ñ —Å–ø–∏—Å–∫—É.
> 2. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ `collect()` –∑ `Collectors.toMap()`.
> 3. –ü–µ—Ä—à–æ—é —Ñ—É–Ω–∫—Ü—ñ—î—é (`keyMapper`) –≤–∫–∞–∑—É—î–º–æ, —â–æ –∫–ª—é—á ‚Äî —Ü–µ —Å–∞–º –µ–ª–µ–º–µ–Ω—Ç (`s -> s` –∞–±–æ `Function.identity()`).
> 4. –î—Ä—É–≥–æ—é —Ñ—É–Ω–∫—Ü—ñ—î—é (`valueMapper`) –≤–∫–∞–∑—É—î–º–æ, —â–æ –∑–Ω–∞—á–µ–Ω–Ω—è ‚Äî —Ü–µ –¥–æ–≤–∂–∏–Ω–∞ –µ–ª–µ–º–µ–Ω—Ç–∞ (`String::length`).

#### **üìù –ü—Ä–∏–∫–ª–∞–¥ –∫–æ–¥—É:**

```java
import java.util.List;
import java.util.Map;
import java.util.stream.Collectors;

public class ToMapSimpleExample {
    public static void main(String[] args) {
        List<String> names = List.of("Alice", "Bob", "Charlie");

        Map<String, Integer> nameLengthMap = names.stream()
            .collect(Collectors.toMap(
                name -> name,               // –ö–ª—é—á: —Å–∞–º–µ —ñ–º'—è
                String::length              // –ó–Ω–∞—á–µ–Ω–Ω—è: –π–æ–≥–æ –¥–æ–≤–∂–∏–Ω–∞
            ));
        
        System.out.println(nameLengthMap); // {Bob=3, Alice=5, Charlie=7} (–ø–æ—Ä—è–¥–æ–∫ –Ω–µ –≥–∞—Ä–∞–Ω—Ç–æ–≤–∞–Ω–∏–π)
    }
}
```

#### **üìå –©–æ –ø–µ—Ä–µ–≤—ñ—Ä—è—é—Ç—å:**

*–ü—Ä–∞–∫—Ç–∏—á–Ω—ñ –Ω–∞–≤–∏—á–∫–∏ –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è `toMap` –¥–ª—è –ø—Ä–æ—Å—Ç–æ–≥–æ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è "—Å–ø–∏—Å–æ–∫ -> –º–∞–ø–∞".*

* * *

### **3 ‚ùì –ü–∏—Ç–∞–Ω–Ω—è:**

–©–æ —Å—Ç–∞–Ω–µ—Ç—å—Å—è, —è–∫—â–æ –ø—Ä–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—ñ `Collectors.toMap()` –≤ –ø–æ—Ç–æ—Ü—ñ –∑—É—Å—Ç—Ä—ñ–Ω—É—Ç—å—Å—è –µ–ª–µ–º–µ–Ω—Ç–∏, —â–æ –≥–µ–Ω–µ—Ä—É—é—Ç—å –æ–¥–Ω–∞–∫–æ–≤—ñ –∫–ª—é—á—ñ?

> #### **üí¨ –í—ñ–¥–ø–æ–≤—ñ–¥—å:**
>
> –Ø–∫—â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –ø—Ä–æ—Å—Ç—É –≤–µ—Ä—Å—ñ—é `Collectors.toMap(keyMapper, valueMapper)`, —ñ –ø—ñ–¥ —á–∞—Å –∑–±–∏—Ä–∞–Ω–Ω—è –≤ –ø–æ—Ç–æ—Ü—ñ –∑—É—Å—Ç—Ä—ñ–Ω–µ—Ç—å—Å—è –¥—É–±–ª—ñ–∫–∞—Ç –∫–ª—é—á–∞, –±—É–¥–µ –∫–∏–Ω—É—Ç–æ –≤–∏–Ω—è—Ç–æ–∫ **`IllegalStateException`** –∑ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è–º –Ω–∞ –∑—Ä–∞–∑–æ–∫ "Duplicate key...".
>
> **–ß–æ–º—É —Ç–∞–∫ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è:**
>
> –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞ `Map` –Ω–µ –¥–æ–∑–≤–æ–ª—è—î –º–∞—Ç–∏ –¥—É–±–ª—ñ–∫–∞—Ç–∏ –∫–ª—é—á—ñ–≤. –ö–æ–ª–∏ –∫–æ–ª–µ–∫—Ç–æ—Ä –Ω–∞–º–∞–≥–∞—î—Ç—å—Å—è –¥–æ–¥–∞—Ç–∏ –≤ –º–∞–ø—É –ø–∞—Ä—É –∑ –∫–ª—é—á–µ–º, —è–∫–∏–π —Ç–∞–º —É–∂–µ —ñ—Å–Ω—É—î, –≤—ñ–Ω –Ω–µ –∑–Ω–∞—î, —â–æ —Ä–æ–±–∏—Ç–∏:
>
> * –ó–∞–ª–∏—à–∏—Ç–∏ —Å—Ç–∞—Ä–µ –∑–Ω–∞—á–µ–Ω–Ω—è?
> * –ó–∞–ø–∏—Å–∞—Ç–∏ –Ω–æ–≤–µ?
> * –û–±'—î–¥–Ω–∞—Ç–∏ —ó—Ö —è–∫–æ—Å—å?
>
> –©–æ–± —É–Ω–∏–∫–Ω—É—Ç–∏ –Ω–µ–ø–µ—Ä–µ–¥–±–∞—á—É–≤–∞–Ω–æ—ó –ø–æ–≤–µ–¥—ñ–Ω–∫–∏, Java –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º "–ø–∞–¥–∞—î" –∑ –ø–æ–º–∏–ª–∫–æ—é.
>
> **–¶–µ –æ–¥–Ω–∞ –∑ –Ω–∞–π–ø–æ—à–∏—Ä–µ–Ω—ñ—à–∏—Ö –ø–æ–º–∏–ª–æ–∫** –ø—Ä–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—ñ `toMap`. –ó–∞–≤–∂–¥–∏ –ø–æ—Ç—Ä—ñ–±–Ω–æ –¥—É–º–∞—Ç–∏ –ø—Ä–æ —Ç–µ, —á–∏ –º–æ–∂—É—Ç—å –≤–∞—à—ñ –∫–ª—é—á—ñ –¥—É–±–ª—é–≤–∞—Ç–∏—Å—è.

#### **üìù –ü—Ä–∏–∫–ª–∞–¥ –ø–æ–º–∏–ª–∫–∏:**

```java
List<String> names = List.of("Anna", "Bob", "Anna"); // "Anna" - –¥—É–±–ª—ñ–∫–∞—Ç
// –¶–µ–π –∫–æ–¥ –≤–ø–∞–¥–µ –∑ IllegalStateException
Map<String, Integer> map = names.stream()
                               .collect(Collectors.toMap(n -> n, String::length)); 
```

#### **üìå –©–æ –ø–µ—Ä–µ–≤—ñ—Ä—è—é—Ç—å:**

*–ó–Ω–∞–Ω–Ω—è –ø–æ—à–∏—Ä–µ–Ω–∏—Ö "–ø–∞—Å—Ç–æ–∫" `Stream API`. –†–æ–∑—É–º—ñ–Ω–Ω—è –ø—Ä–æ–±–ª–µ–º–∏ –∑ –¥—É–±–ª—ñ–∫–∞—Ç–∞–º–∏ –∫–ª—é—á—ñ–≤ —î –∫—Ä–∏—Ç–∏—á–Ω–æ –≤–∞–∂–ª–∏–≤–∏–º.*

* * *

### **4 ‚ùì –ü–∏—Ç–∞–Ω–Ω—è:**

–Ø–∫ –æ–±—Ä–æ–±–∏—Ç–∏ –¥—É–±–ª—ñ–∫–∞—Ç–∏ –∫–ª—é—á—ñ–≤ –ø—Ä–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—ñ `Collectors.toMap()`?

> #### **üí¨ –í—ñ–¥–ø–æ–≤—ñ–¥—å:**
>
> –î–ª—è —Ü—å–æ–≥–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **–ø–µ—Ä–µ–≤–∞–Ω—Ç–∞–∂–µ–Ω—É –≤–µ—Ä—Å—ñ—é** `toMap`, —è–∫–∞ –ø—Ä–∏–π–º–∞—î —Ç—Ä–µ—Ç—ñ–π –∞—Ä–≥—É–º–µ–Ω—Ç ‚Äî **—Ñ—É–Ω–∫—Ü—ñ—é –∑–ª–∏—Ç—Ç—è (merge function)**.
>
> **`toMap(keyMapper, valueMapper, mergeFunction)`**
>
> * **`mergeFunction`**: –¶–µ `BinaryOperator`, —è–∫–∏–π –ø—Ä–∏–π–º–∞—î –¥–≤–∞ –∑–Ω–∞—á–µ–Ω–Ω—è (`oldValue`, `newValue`), —â–æ –∞—Å–æ—Ü—ñ—é—é—Ç—å—Å—è –∑ –æ–¥–Ω–∞–∫–æ–≤–∏–º –∫–ª—é—á–µ–º, —ñ –≤–∏—Ä—ñ—à—É—î, —è–∫–µ –∑–Ω–∞—á–µ–Ω–Ω—è –∑–∞–ª–∏—à–∏—Ç–∏ –∞–±–æ —è–∫ —ó—Ö –æ–±'—î–¥–Ω–∞—Ç–∏.
>
> **–ü–æ–ø—É–ª—è—Ä–Ω—ñ —Å—Ç—Ä–∞—Ç–µ–≥—ñ—ó –∑–ª–∏—Ç—Ç—è:**
>
> * `(existing, replacement) -> existing`: –ó–∞–ª–∏—à–∏—Ç–∏ **–ø–µ—Ä—à–µ** –∑—É—Å—Ç—Ä—ñ–Ω—É—Ç–µ –∑–Ω–∞—á–µ–Ω–Ω—è.
> * `(existing, replacement) -> replacement`: –ü–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç–∏ **–Ω–æ–≤–∏–º** –∑–Ω–∞—á–µ–Ω–Ω—è–º.
> * `Integer::sum`: –Ø–∫—â–æ –∑–Ω–∞—á–µ–Ω–Ω—è ‚Äî —á–∏—Å–ª–∞, –º–æ–∂–Ω–∞ —ó—Ö **–ø—Ä–æ—Å—É–º—É–≤–∞—Ç–∏**.

#### **üìù –ü—Ä–∏–∫–ª–∞–¥ (–ø—ñ–¥—Ä–∞—Ö—É–Ω–æ–∫ –∫—ñ–ª—å–∫–æ—Å—Ç—ñ):**

–ü—ñ–¥—Ä–∞—Ö—É—î–º–æ, —Å–∫—ñ–ª—å–∫–∏ —Ä–∞–∑—ñ–≤ –∫–æ–∂–Ω–µ —ñ–º'—è –∑—É—Å—Ç—Ä—ñ—á–∞—î—Ç—å—Å—è –≤ —Å–ø–∏—Å–∫—É.

```java
List<String> names = List.of("Anna", "Bob", "Anna", "Charlie", "Bob", "Anna");
Map<String, Integer> nameCounts = names.stream()
    .collect(Collectors.toMap(
        name -> name,               // –ö–ª—é—á: —ñ–º'—è
        name -> 1,                  // –ü–æ—á–∞—Ç–∫–æ–≤–µ –∑–Ω–∞—á–µ–Ω–Ω—è: 1
        (existingCount, newCount) -> existingCount + newCount // –§—É–Ω–∫—Ü—ñ—è –∑–ª–∏—Ç—Ç—è: –¥–æ–¥–∞—î–º–æ 1 –¥–æ —ñ—Å–Ω—É—é—á–æ–≥–æ
        // –ê–±–æ –∫–æ—Ä–æ—Ç—à–µ: Integer::sum
    ));
    
System.out.println(nameCounts); // {Bob=2, Anna=3, Charlie=1}
```

#### **üìå –©–æ –ø–µ—Ä–µ–≤—ñ—Ä—è—é—Ç—å:**

*–ó–Ω–∞–Ω–Ω—è –ø—Ä–æ—Å—É–Ω—É—Ç–∏—Ö –º–æ–∂–ª–∏–≤–æ—Å—Ç–µ–π –∫–æ–ª–µ–∫—Ç–æ—Ä—ñ–≤ —Ç–∞ –≤–º—ñ–Ω–Ω—è –≤–∏—Ä—ñ—à—É–≤–∞—Ç–∏ –ø–æ—à–∏—Ä–µ–Ω—É –ø—Ä–æ–±–ª–µ–º—É –∑ –¥—É–±–ª—ñ–∫–∞—Ç–∞–º–∏ –∫–ª—é—á—ñ–≤. –¶–µ –ø–∏—Ç–∞–Ω–Ω—è —î –æ–±–æ–≤'—è–∑–∫–æ–≤–∏–º –Ω–∞ —Å–ø—ñ–≤–±–µ—Å—ñ–¥–∞—Ö.*

* * *

### **5 ‚ùì –ü–∏—Ç–∞–Ω–Ω—è:**

–Ø–∫ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é `Collectors.toMap()` —Å—Ç–≤–æ—Ä–∏—Ç–∏ –º–∞–ø—É –ø–µ–≤–Ω–æ–≥–æ —Ç–∏–ø—É, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `TreeMap`, —â–æ–± –∫–ª—é—á—ñ –±—É–ª–∏ –≤—ñ–¥—Å–æ—Ä—Ç–æ–≤–∞–Ω—ñ?

> #### **üí¨ –í—ñ–¥–ø–æ–≤—ñ–¥—å:**
>
> –î–ª—è —Ü—å–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —â–µ –±—ñ–ª—å—à —Ä–æ–∑—à–∏—Ä–µ–Ω–∞ –≤–µ—Ä—Å—ñ—è `toMap`, —è–∫–∞ –ø—Ä–∏–π–º–∞—î **—á–µ—Ç–≤–µ—Ä—Ç–∏–π** –∞—Ä–≥—É–º–µ–Ω—Ç ‚Äî **–ø–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫–∞ –º–∞–ø–∏ (`mapSupplier`)**.
>
> **`toMap(keyMapper, valueMapper, mergeFunction, mapSupplier)`**
>
> * **`mapSupplier`**: –¶–µ `Supplier`, —è–∫–∏–π –Ω–∞–¥–∞—î **–Ω–æ–≤–∏–π, –ø–æ—Ä–æ–∂–Ω—ñ–π –µ–∫–∑–µ–º–ø–ª—è—Ä –º–∞–ø–∏**, –≤ —è–∫—É –±—É–¥—É—Ç—å –∑–±–∏—Ä–∞—Ç–∏—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏. –ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º —Ü–µ `HashMap::new`.
>
> –©–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ `TreeMap` (—è–∫–∏–π –∑–±–µ—Ä—ñ–≥–∞—î –∫–ª—é—á—ñ —É –≤—ñ–¥—Å–æ—Ä—Ç–æ–≤–∞–Ω–æ–º—É –ø–æ—Ä—è–¥–∫—É), –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç–∏ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –π–æ–≥–æ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä: `TreeMap::new`.

#### **üìù –ü—Ä–∏–∫–ª–∞–¥:**

```java
List<String> names = List.of("Charlie", "Alice", "Bob");

// –ó–±–∏—Ä–∞—î–º–æ –≤ TreeMap –¥–ª—è —Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è –∫–ª—é—á—ñ–≤ –∑–∞ –∞–ª—Ñ–∞–≤—ñ—Ç–æ–º
TreeMap<String, Integer> sortedMap = names.stream()
    .collect(Collectors.toMap(
        name -> name,
        String::length,
        (v1, v2) -> v1,     // –§—É–Ω–∫—Ü—ñ—è –∑–ª–∏—Ç—Ç—è (–ø—Ä–æ—Å—Ç–æ –±–µ—Ä–µ–º–æ –ø–µ—Ä—à–µ –∑–Ω–∞—á–µ–Ω–Ω—è)
        TreeMap::new        // –ü–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫ –º–∞–ø–∏
    ));

System.out.println(sortedMap); // {Alice=5, Bob=3, Charlie=7}
```

#### **üìå –©–æ –ø–µ—Ä–µ–≤—ñ—Ä—è—é—Ç—å:**

*–ó–Ω–∞–Ω–Ω—è –ø–æ–≤–Ω–æ—ó —Å–∏–≥–Ω–∞—Ç—É—Ä–∏ `toMap` —Ç–∞ –∑–¥–∞—Ç–Ω—ñ—Å—Ç—å –≥–Ω—É—á–∫–æ –Ω–∞–ª–∞—à—Ç–æ–≤—É–≤–∞—Ç–∏ –ø—Ä–æ—Ü–µ—Å –∑–±–æ—Ä—É –¥–∞–Ω–∏—Ö, –≤–∫–∞–∑—É—é—á–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—é `Map`.*

* * *

### **6 ‚ùì –ü–∏—Ç–∞–Ω–Ω—è:**

–ù–∞–≤–µ–¥—ñ—Ç—å –ø—Ä–∏–∫–ª–∞–¥ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å–ø–∏—Å–∫—É –æ–±'—î–∫—Ç—ñ–≤ `User` –Ω–∞ `Map<Long, User>`.

> #### **üí¨ –í—ñ–¥–ø–æ–≤—ñ–¥—å:**
>
> –¶–µ –∫–ª–∞—Å–∏—á–Ω–∞ –∑–∞–¥–∞—á–∞ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å–ø–∏—Å–∫—É –Ω–∞ –º–∞–ø—É –¥–ª—è —à–≤–∏–¥–∫–æ–≥–æ –¥–æ—Å—Ç—É–ø—É –∑–∞ ID.
>
> **–ó–∞–¥–∞—á–∞:** –Ñ `List<User>`, –ø–æ—Ç—Ä—ñ–±–Ω–æ –æ—Ç—Ä–∏–º–∞—Ç–∏ `Map<Long, User>`, –¥–µ –∫–ª—é—á ‚Äî —Ü–µ `user.getId()`, –∞ –∑–Ω–∞—á–µ–Ω–Ω—è ‚Äî —Å–∞–º –æ–±'—î–∫—Ç `User`.
>
> **–†—ñ—à–µ–Ω–Ω—è:**
> –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ `toMap`, –¥–µ `keyMapper` –≤–∏—Ç—è–≥—É—î ID, –∞ `valueMapper` –ø–æ–≤–µ—Ä—Ç–∞—î —Å–∞–º –æ–±'—î–∫—Ç –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é `Function.identity()`.

#### **üìù –ü—Ä–∏–∫–ª–∞–¥:**

```java
class User {
    private Long id;
    private String name;
    // getters...
}
List<User> users = List.of(new User(1L, "Alice"), new User(2L, "Bob"));

Map<Long, User> userMap = users.stream()
    .collect(Collectors.toMap(
        User::getId,              // –ö–ª—é—á - ID –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
        Function.identity()       // –ó–Ω–∞—á–µ–Ω–Ω—è - —Å–∞–º –æ–±'—î–∫—Ç User
    ));
```

#### **–ö–æ–º–µ–Ω—Ç–∞—Ä:**

–¢—É—Ç –º–∏ –ø—Ä–∏–ø—É—Å–∫–∞—î–º–æ, —â–æ ID —É–Ω—ñ–∫–∞–ª—å–Ω—ñ, —ñ–Ω–∞–∫—à–µ –∑–Ω–∞–¥–æ–±–∏–ª–∞—Å—è –± —Ñ—É–Ω–∫—Ü—ñ—è –∑–ª–∏—Ç—Ç—è.

#### **üìå –©–æ –ø–µ—Ä–µ–≤—ñ—Ä—è—é—Ç—å:**

*–í–æ–ª–æ–¥—ñ–Ω–Ω—è —ñ–¥—ñ–æ–º–∞—Ç–∏—á–Ω–∏–º–∏ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è–º–∏ `Stream API`. `Function.identity()` —É —Ü—å–æ–º—É –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ ‚Äî –¥—É–∂–µ –ø–æ—à–∏—Ä–µ–Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–∞.*

* * *

### **7 ‚ùì –ü–∏—Ç–∞–Ω–Ω—è:**

–£ —á–æ–º—É —Ä—ñ–∑–Ω–∏—Ü—è –º—ñ–∂ `Collectors.toMap()` —Ç–∞ `Collectors.groupingBy()`? ‚≠êÔ∏è

> #### **üí¨ –í—ñ–¥–ø–æ–≤—ñ–¥—å:**
>
> –û–±–∏–¥–≤–∞ –∫–æ–ª–µ–∫—Ç–æ—Ä–∏ —Å—Ç–≤–æ—Ä—é—é—Ç—å `Map`, –∞–ª–µ –≤–æ–Ω–∏ –≤–∏—Ä—ñ—à—É—é—Ç—å —Ä—ñ–∑–Ω—ñ –∑–∞–≤–¥–∞–Ω–Ω—è.
>
> * **`Collectors.toMap()`:**
>   * **–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è:** **–ü–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è**. –°—Ç–≤–æ—Ä—é—î `Map` –∑ –ø—Ä–∏–ø—É—â–µ–Ω–Ω—è–º, —â–æ –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –∫–ª—é—á–∞ –±—É–¥–µ **–æ–¥–∏–Ω** –µ–ª–µ–º–µ–Ω—Ç (–∞–±–æ —ó—Ö –ø–æ—Ç—Ä—ñ–±–Ω–æ "–∑–ª–∏—Ç–∏" –≤ –æ–¥–∏–Ω).
>   * **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ó–∞–∑–≤–∏—á–∞–π `Map<K, V>`.
>   * **–î—É–±–ª—ñ–∫–∞—Ç–∏ –∫–ª—é—á—ñ–≤:** –ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º –∫–∏–¥–∞—î –≤–∏–Ω—è—Ç–æ–∫.
>
> * **`Collectors.groupingBy()`:**
>   * **–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è:** **–ì—Ä—É–ø—É–≤–∞–Ω–Ω—è**. –°—Ç–≤–æ—Ä—é—î `Map`, –¥–µ –µ–ª–µ–º–µ–Ω—Ç–∏ –∑ –æ–¥–Ω–∞–∫–æ–≤–∏–º –∫–ª—é—á–µ–º –æ–±'—î–¥–Ω—É—é—Ç—å—Å—è –≤ **—Å–ø–∏—Å–æ–∫**.
>   * **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ó–∞–≤–∂–¥–∏ `Map<K, List<V>>` (–∞–±–æ —ñ–Ω—à–∞ –∫–æ–ª–µ–∫—Ü—ñ—è, —è–∫—â–æ –≤–∫–∞–∑–∞—Ç–∏ downstream collector).
>   * **–î—É–±–ª—ñ–∫–∞—Ç–∏ –∫–ª—é—á—ñ–≤:** –¶–µ **–æ—á—ñ–∫—É–≤–∞–Ω–∞ –ø–æ–≤–µ–¥—ñ–Ω–∫–∞**. –£—Å—ñ –µ–ª–µ–º–µ–Ω—Ç–∏ –∑ –æ–¥–Ω–∞–∫–æ–≤–∏–º –∫–ª—é—á–µ–º –ø—Ä–æ—Å—Ç–æ –¥–æ–¥–∞—é—Ç—å—Å—è –¥–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ–≥–æ —Å–ø–∏—Å–∫—É.
>
> **–ö–æ–ª–∏ —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏:**
>
> * `toMap`: –∫–æ–ª–∏ –ø–æ—Ç—Ä—ñ–±–Ω–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Å–ª–æ–≤–Ω–∏–∫ –∞–±–æ —ñ–Ω–¥–µ–∫—Å (`ID -> –û–±'—î–∫—Ç`).
> * `groupingBy`: –∫–æ–ª–∏ –ø–æ—Ç—Ä—ñ–±–Ω–æ —Ä–æ–∑–±–∏—Ç–∏ –¥–∞–Ω—ñ –Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó (`–ú—ñ—Å—Ç–æ -> –°–ø–∏—Å–æ–∫ –∂–∏—Ç–µ–ª—ñ–≤`).

#### **üìå –©–æ –ø–µ—Ä–µ–≤—ñ—Ä—è—é—Ç—å:**

*–ó–¥–∞—Ç–Ω—ñ—Å—Ç—å –æ–±–∏—Ä–∞—Ç–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π –∫–æ–ª–µ–∫—Ç–æ—Ä –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ—ó –∑–∞–¥–∞—á—ñ. –¶–µ –¥–µ–º–æ–Ω—Å—Ç—Ä—É—î –≥–ª–∏–±–æ–∫–µ —Ä–æ–∑—É–º—ñ–Ω–Ω—è –º–æ–∂–ª–∏–≤–æ—Å—Ç–µ–π Stream API.*

* * *

### **8 ‚ùì –ü–∏—Ç–∞–Ω–Ω—è:**

–ß–∏ –º–æ–∂–µ `toMap` –ø–æ–≤–µ—Ä–Ω—É—Ç–∏ `ConcurrentMap`? –Ø–∫—â–æ —Ç–∞–∫, —Ç–æ —è–∫? ‚≠êÔ∏è

> #### **üí¨ –í—ñ–¥–ø–æ–≤—ñ–¥—å:**
>
> **–¢–∞–∫, –º–æ–∂–µ.** –î–ª—è —Ü—å–æ–≥–æ —ñ—Å–Ω—É—é—Ç—å —Å–ø–µ—Ü—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ –∫–æ–ª–µ–∫—Ç–æ—Ä–∏.
>
> * **`Collectors.toConcurrentMap()`:**
>     –¶–µ –∞–Ω–∞–ª–æ–≥ `toMap`, —è–∫–∏–π —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–æ —Ä–æ–∑—Ä–æ–±–ª–µ–Ω–∏–π –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤ **–ø–∞—Ä–∞–ª–µ–ª—å–Ω–∏—Ö –ø–æ—Ç–æ–∫–∞—Ö (`parallelStream()`)** —ñ –≥–∞—Ä–∞–Ω—Ç–æ–≤–∞–Ω–æ –ø–æ–≤–µ—Ä—Ç–∞—î –ø–æ—Ç–æ–∫–æ–±–µ–∑–ø–µ—á–Ω—É —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—é `Map`, –∑–∞–∑–≤–∏—á–∞–π `ConcurrentHashMap`.
>
>     –í—ñ–Ω —Ç–∞–∫–æ–∂ –º–∞—î –ø–µ—Ä–µ–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ –≤–µ—Ä—Å—ñ—ó –¥–ª—è –æ–±—Ä–æ–±–∫–∏ –¥—É–±–ª—ñ–∫–∞—Ç—ñ–≤ –∫–ª—é—á—ñ–≤ —Ç–∞ –≤–∫–∞–∑–∞–Ω–Ω—è –ø–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫–∞.
>
>     ```java
>     ConcurrentMap<Type, Long> counts = things.parallelStream()
>         .collect(Collectors.toConcurrentMap(
>             Thing::getType,
>             t -> 1L,
>             Long::sum
>         ));
>     ```
>
> * –¢–∞–∫–æ–∂ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –∑–≤–∏—á–∞–π–Ω–∏–π `toMap`, —è–≤–Ω–æ –ø–µ—Ä–µ–¥–∞–≤—à–∏ `ConcurrentHashMap::new` —è–∫ —á–µ—Ç–≤–µ—Ä—Ç–∏–π –∞—Ä–≥—É–º–µ–Ω—Ç, –∞–ª–µ `toConcurrentMap` —î –±—ñ–ª—å—à —ñ–¥—ñ–æ–º–∞—Ç–∏—á–Ω–∏–º –¥–ª—è –ø–∞—Ä–∞–ª–µ–ª—å–Ω–∏—Ö –æ–±—á–∏—Å–ª–µ–Ω—å.

#### **üìå –©–æ –ø–µ—Ä–µ–≤—ñ—Ä—è—é—Ç—å:**

*–ó–Ω–∞–Ω–Ω—è API –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ –±–∞–≥–∞—Ç–æ–ø–æ—Ç–æ–∫–æ–≤—ñ—Å—Ç—é —Ç–∞ –ø–∞—Ä–∞–ª–µ–ª—å–Ω–∏–º–∏ —Å—Ç—Ä—ñ–º–∞–º–∏.*

* * *

### **9 ‚ùì –ü–∏—Ç–∞–Ω–Ω—è:**

–Ø–∫–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–≤–µ—Ä–Ω–µ `Stream.empty().collect(Collectors.toMap(...))`? ‚≠êÔ∏è‚≠êÔ∏è

> #### **üí¨ –í—ñ–¥–ø–æ–≤—ñ–¥—å:**
>
> –¶–µ–π –≤–∏–∫–ª–∏–∫ –∫–æ—Ä–µ–∫—Ç–Ω–æ –ø–æ–≤–µ—Ä–Ω–µ **–ø–æ—Ä–æ–∂–Ω—é `Map` (`{}`)**.
>
> –ö–æ–ª–µ–∫—Ç–æ—Ä–∏ –≤ `Stream API` —Ä–æ–∑—Ä–æ–±–ª–µ–Ω—ñ —Ç–∞–∫, —â–æ–± –≥—Ä–∞—Ü—ñ–π–Ω–æ –æ–±—Ä–æ–±–ª—è—Ç–∏ –ø–æ—Ä–æ–∂–Ω—ñ –ø–æ—Ç–æ–∫–∏. –¢–µ—Ä–º—ñ–Ω–∞–ª—å–Ω–∞ –æ–ø–µ—Ä–∞—Ü—ñ—è `collect` –Ω–∞ –ø–æ—Ä–æ–∂–Ω—å–æ–º—É –ø–æ—Ç–æ—Ü—ñ –ø—Ä–æ—Å—Ç–æ –ø–æ–≤–µ—Ä—Ç–∞—î –ø–æ—Ä–æ–∂–Ω—ñ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, —Å—Ç–≤–æ—Ä–µ–Ω–∏–π –ø–æ—Å—Ç–∞—á–∞–ª—å–Ω–∏–∫–æ–º –∫–æ–ª–µ–∫—Ç–æ—Ä–∞ (`supplier`).
>
> –£ –≤–∏–ø–∞–¥–∫—É `Collectors.toMap`, –±—É–¥–µ —Å—Ç–≤–æ—Ä–µ–Ω–æ –ø–æ—Ä–æ–∂–Ω—ñ–π `HashMap`, —ñ –æ—Å–∫—ñ–ª—å–∫–∏ –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ –¥–ª—è –æ–±—Ä–æ–±–∫–∏ –Ω–µ–º–∞—î, –≤—ñ–Ω —Ç–∞–∫–∏–º —ñ –∑–∞–ª–∏—à–∏—Ç—å—Å—è. –¶–µ —Ä–æ–±–∏—Ç—å –∫–æ–¥, —â–æ –ø—Ä–∞—Ü—é—î –∑—ñ —Å—Ç—Ä—ñ–º–∞–º–∏, –±—ñ–ª—å—à –Ω–∞–¥—ñ–π–Ω–∏–º, –æ—Å–∫—ñ–ª—å–∫–∏ –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ –¥–æ–¥–∞–≤–∞—Ç–∏ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ `if (stream != null && !stream.isEmpty())`.

#### **üìå –©–æ –ø–µ—Ä–µ–≤—ñ—Ä—è—é—Ç—å:**

*–†–æ–∑—É–º—ñ–Ω–Ω—è —Ç–æ–≥–æ, —è–∫ –∫–æ–ª–µ–∫—Ç–æ—Ä–∏ –æ–±—Ä–æ–±–ª—è—é—Ç—å –∫—Ä–∞–π–Ω—ñ –≤–∏–ø–∞–¥–∫–∏ (edge cases), —è–∫-–æ—Ç –ø–æ—Ä–æ–∂–Ω—ñ –ø–æ—Ç–æ–∫–∏.*

* * *

### **10 ‚ùì –ü–∏—Ç–∞–Ω–Ω—è:**

–Ø–∫ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é `toMap` —Ç–∞ —Ñ—É–Ω–∫—Ü—ñ—ó –∑–ª–∏—Ç—Ç—è –∑–Ω–∞–π—Ç–∏ –Ω–∞–π–Ω–æ–≤—ñ—à–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –º—ñ—Å—Ç–∞? ‚≠êÔ∏è‚≠êÔ∏è

> #### **üí¨ –í—ñ–¥–ø–æ–≤—ñ–¥—å:**
>
> **–ó–∞–¥–∞—á–∞:** –Ñ `List<User>`, –¥–µ `User` –º–∞—î –ø–æ–ª—è `city` —Ç–∞ `registrationDate`. –ü–æ—Ç—Ä—ñ–±–Ω–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ `Map<String, User>`, –¥–µ –∫–ª—é—á ‚Äî –º—ñ—Å—Ç–æ, –∞ –∑–Ω–∞—á–µ–Ω–Ω—è ‚Äî –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –∑ —Ü—å–æ–≥–æ –º—ñ—Å—Ç–∞ –∑ –Ω–∞–π–ø—ñ–∑–Ω—ñ—à–æ—é –¥–∞—Ç–æ—é —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó.
>
> **–†—ñ—à–µ–Ω–Ω—è:**
>
> 1. –ö–ª—é—á–µ–º –±—É–¥–µ `user.getCity()`.
> 2. –ó–Ω–∞—á–µ–Ω–Ω—è–º ‚Äî —Å–∞–º `user`.
> 3. **–§—É–Ω–∫—Ü—ñ—è –∑–ª–∏—Ç—Ç—è** (`mergeFunction`) –±—É–¥–µ –≤–∏–∫–ª–∏–∫–∞–Ω–∞, –∫–æ–ª–∏ –∑—É—Å—Ç—Ä—ñ–Ω–µ—Ç—å—Å—è –¥—É–±–ª—ñ–∫–∞—Ç –∫–ª—é—á–∞ (—Ç–æ–±—Ç–æ —ñ–Ω—à–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –∑ —Ç–æ–≥–æ –∂ –º—ñ—Å—Ç–∞). –£ –Ω—ñ–π –º–∏ –ø–æ—Ä—ñ–≤–Ω—é—î–º–æ –¥–≤–æ—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ (`existingUser`, `newUser`) –∑–∞ –¥–∞—Ç–æ—é —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó —ñ –ø–æ–≤–µ—Ä—Ç–∞—î–º–æ —Ç–æ–≥–æ, —É –∫–æ–≥–æ –¥–∞—Ç–∞ –ø—ñ–∑–Ω—ñ—à–∞.

#### **üìù –ü—Ä–∏–∫–ª–∞–¥ –∫–æ–¥—É:**

```java
Map<String, User> latestUserInCity = users.stream()
    .collect(Collectors.toMap(
        User::getCity,
        user -> user,
        (existing, aNew) -> 
            existing.getRegistrationDate().isAfter(aNew.getRegistrationDate()) 
            ? existing : aNew
    ));
```

#### **üìå –©–æ –ø–µ—Ä–µ–≤—ñ—Ä—è—é—Ç—å:**

*–í–º—ñ–Ω–Ω—è —Ä–µ–∞–ª—ñ–∑–æ–≤—É–≤–∞—Ç–∏ —Å–∫–ª–∞–¥–Ω—É –ª–æ–≥—ñ–∫—É –∑–ª–∏—Ç—Ç—è. –¶–µ –ø–æ–∫–∞–∑—É—î –≥–ª–∏–±–æ–∫–µ –≤–æ–ª–æ–¥—ñ–Ω–Ω—è —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º `toMap`.*

* * *

### **11 ‚ùì –ü–∏—Ç–∞–Ω–Ω—è:**

–ß–æ–º—É `Function.identity()` —Ç–∞–∫ —á–∞—Å—Ç–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –∑ `Collectors.toMap`? ‚≠êÔ∏è‚≠êÔ∏è

> #### **üí¨ –í—ñ–¥–ø–æ–≤—ñ–¥—å:**
>
> **`Function.identity()`** (—è–∫–∞ —î –µ–∫–≤—ñ–≤–∞–ª–µ–Ω—Ç–æ–º `t -> t`) —á–∞—Å—Ç–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —è–∫ `valueMapper`, –∫–æ–ª–∏ –Ω–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ, —â–æ–± **–∑–Ω–∞—á–µ–Ω–Ω—è–º —É –º–∞–ø—ñ –±—É–≤ —Å–∞–º –µ–ª–µ–º–µ–Ω—Ç –ø–æ—Ç–æ–∫—É**.
>
> **–ö–ª–∞—Å–∏—á–Ω–∏–π —Å—Ü–µ–Ω–∞—Ä—ñ–π ‚Äî —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —ñ–Ω–¥–µ–∫—Å—É.**
> –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —É –Ω–∞—Å —î `List<Product>`, —ñ –º–∏ —Ö–æ—á–µ–º–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ `Map<String, Product>` –¥–ª—è —à–≤–∏–¥–∫–æ–≥–æ –¥–æ—Å—Ç—É–ø—É –¥–æ —Ç–æ–≤–∞—Ä—É –∑–∞ –π–æ–≥–æ —É–Ω—ñ–∫–∞–ª—å–Ω–∏–º –∞—Ä—Ç–∏–∫—É–ª–æ–º.
>
> ```java
> Map<String, Product> productIndex = products.stream()
>     .collect(Collectors.toMap(
>         Product::getSku,     // –ö–ª—é—á - –∞—Ä—Ç–∏–∫—É–ª
>         Function.identity()  // –ó–Ω–∞—á–µ–Ω–Ω—è - —Å–∞–º –æ–±'—î–∫—Ç Product
>     ));
> ```
>
> `Function.identity()` —Ä–æ–±–∏—Ç—å –∫–æ–¥ –±—ñ–ª—å—à –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω–∏–º —ñ —á–∏—Ç–∞–±–µ–ª—å–Ω–∏–º. –¶–µ —è–≤–Ω–æ –≥–æ–≤–æ—Ä–∏—Ç—å: "–±–µ—Ä–∏ —Å–∞–º –µ–ª–µ–º–µ–Ω—Ç —è–∫ –∑–Ω–∞—á–µ–Ω–Ω—è".

#### **üìå –©–æ –ø–µ—Ä–µ–≤—ñ—Ä—è—é—Ç—å:**

*–ó–Ω–∞–Ω–Ω—è —ñ–¥—ñ–æ–º —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è –≤ Java. –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è `identity()` ‚Äî –æ–¥–Ω–∞ –∑ —Ç–∞–∫–∏—Ö —ñ–¥—ñ–æ–º.*

* * *

### **12 ‚ùì –ü–∏—Ç–∞–Ω–Ω—è:**

–£—è–≤—ñ—Ç—å, —â–æ `keyMapper` –≤ `toMap` –ø–æ–≤–µ—Ä—Ç–∞—î `null` –¥–ª—è –æ–¥–Ω–æ–≥–æ –∑ –µ–ª–µ–º–µ–Ω—Ç—ñ–≤. –©–æ —Å—Ç–∞–Ω–µ—Ç—å—Å—è? ‚≠êÔ∏è‚≠êÔ∏è

> #### **üí¨ –í—ñ–¥–ø–æ–≤—ñ–¥—å:**
>
> –¶–µ –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó `Map`.
>
> * **–Ø–∫—â–æ `toMap` –∑–±–∏—Ä–∞—î –≤ `HashMap` (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º):**
>     –¶–µ –ø—Ä–∏–∑–≤–µ–¥–µ –¥–æ **`NullPointerException`**. –ú–µ—Ç–æ–¥ `toMap` –ø—ñ–¥ –∫–∞–ø–æ—Ç–æ–º –≤–∏–∫–ª–∏–∫–∞—î `Map.merge()`, —è–∫–∏–π, –≤ —Å–≤–æ—é —á–µ—Ä–≥—É, –Ω–∞ `HashMap`'—ñ –Ω–µ –¥–æ–∑–≤–æ–ª—è—î `null`-–∫–ª—é—á—ñ —ñ –∫–∏–Ω–µ `NPE`.
>
> * **–Ø–∫—â–æ `toMap` –∑–±–∏—Ä–∞—î –≤ `TreeMap`:**
>     –ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º `TreeMap` —Ç–∞–∫–æ–∂ –Ω–µ –¥–æ–∑–≤–æ–ª—è—î `null`-–∫–ª—é—á—ñ —ñ –∫–∏–Ω–µ `NullPointerException`.
>
> * **–Ø–∫—â–æ `toMap` –∑–±–∏—Ä–∞—î –≤ `ConcurrentHashMap`:**
>     `ConcurrentHashMap` –∫–∞—Ç–µ–≥–æ—Ä–∏—á–Ω–æ –∑–∞–±–æ—Ä–æ–Ω—è—î `null` —ñ —è–∫ –∫–ª—é—á—ñ, —ñ —è–∫ –∑–Ω–∞—á–µ–Ω–Ω—è, —Ç–æ–º—É —Ç–∞–∫–æ–∂ –±—É–¥–µ `NPE`.
>
> **–Ø–∫ —É–Ω–∏–∫–Ω—É—Ç–∏:**
> –ó–∞–≤–∂–¥–∏ –ø–æ—Ç—Ä—ñ–±–Ω–æ **—Ñ—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏** –µ–ª–µ–º–µ–Ω—Ç–∏, —è–∫—ñ –º–æ–∂—É—Ç—å –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ `null`-–∫–ª—é—á, –ø–µ—Ä–µ–¥ –≤–∏–∫–ª–∏–∫–æ–º `collect`.
>
> ```java
> stream
>   .filter(obj -> obj.getKeyField() != null)
>   .collect(Collectors.toMap(...));
> ```
>
> –¶–µ –≥–∞—Ä–∞–Ω—Ç—É—î, —â–æ `toMap` –æ—Ç—Ä–∏–º–∞—î –ª–∏—à–µ –≤–∞–ª—ñ–¥–Ω—ñ –¥–∞–Ω—ñ.

#### **üìå –©–æ –ø–µ—Ä–µ–≤—ñ—Ä—è—é—Ç—å:**

*–ó–Ω–∞–Ω–Ω—è –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ñ–≤ –æ—Å–Ω–æ–≤–Ω–∏—Ö —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ–π `Map` —â–æ–¥–æ `null`-–∫–ª—é—á—ñ–≤ —Ç–∞ –≤–º—ñ–Ω–Ω—è –ø–∏—Å–∞—Ç–∏ –±–µ–∑–ø–µ—á–Ω–∏–π –∫–æ–¥, —â–æ –≤—Ä–∞—Ö–æ–≤—É—î —Ü—ñ –æ–±–º–µ–∂–µ–Ω–Ω—è.*

* * *

### **13 ‚ùì –ü–∏—Ç–∞–Ω–Ω—è:**

–ß–∏ –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ `Collectors.toMap` –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –º–∞–ø–∏, –¥–µ –∑–Ω–∞—á–µ–Ω–Ω—è–º —î —Å–ø–∏—Å–æ–∫ (`Map<K, List<V>>`)? –ß–∏–º —Ü–µ –≤—ñ–¥—Ä—ñ–∑–Ω—è—î—Ç—å—Å—è –≤—ñ–¥ `groupingBy`? ‚≠êÔ∏è‚≠êÔ∏è

> #### **üí¨ –í—ñ–¥–ø–æ–≤—ñ–¥—å:**
>
> **–¢–µ—Ö–Ω—ñ—á–Ω–æ —Ç–∞–∫, –∞–ª–µ —Ü–µ –∑–Ω–∞—á–Ω–æ —Å–∫–ª–∞–¥–Ω—ñ—à–µ —ñ —î –∞–Ω—Ç–∏–ø–∞—Ç–µ—Ä–Ω–æ–º.** –ö—Ä–∞—â–∏–º —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º –¥–ª—è —Ü—å–æ–≥–æ —î `Collectors.groupingBy()`.
>
> **–Ø–∫ —Ü–µ –º–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏ –∑ `toMap`:**
> –ü–æ—Ç—Ä—ñ–±–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç–∏ –¥—É–∂–µ —Å–∫–ª–∞–¥–Ω—É `mergeFunction`, —è–∫–∞ –ø–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ –∫–ª—é—á —É–∂–µ —ñ—Å–Ω—É—î, —ñ —è–∫—â–æ —Ç–∞–∫ ‚Äî –¥–æ–¥–∞—î –Ω–æ–≤–µ –∑–Ω–∞—á–µ–Ω–Ω—è –¥–æ —ñ—Å–Ω—É—é—á–æ–≥–æ —Å–ø–∏—Å–∫—É, –∞ —è–∫—â–æ –Ω—ñ ‚Äî —Å—Ç–≤–æ—Ä—é—î –Ω–æ–≤–∏–π —Å–ø–∏—Å–æ–∫.
>
> ```java
> Map<String, List<Integer>> map = numbers.stream()
>     .collect(Collectors.toMap(
>         keyFunction,
>         value -> new ArrayList<>(List.of(value)), // –ü–æ–≤–µ—Ä—Ç–∞—î–º–æ —Å–ø–∏—Å–æ–∫ –∑ –æ–¥–Ω–æ–≥–æ –µ–ª–µ–º–µ–Ω—Ç–∞
>         (list1, list2) -> { list1.addAll(list2); return list1; } // –°–∫–ª–∞–¥–Ω–∞ merge-—Ñ—É–Ω–∫—Ü—ñ—è
>     ));
> ```
>
> **–ß–∏–º –∫—Ä–∞—â–∏–π `groupingBy`:**
> `groupingBy` —Ä–æ–±–∏—Ç—å —Ü–µ "–∑ –∫–æ—Ä–æ–±–∫–∏" ‚Äî –≤—ñ–Ω —Å—Ç–≤–æ—Ä–µ–Ω–∏–π —Å–∞–º–µ –¥–ª—è —Ü—ñ—î—ó –∑–∞–¥–∞—á—ñ.
>
> ```java
> Map<String, List<Integer>> map = numbers.stream()
>     .collect(Collectors.groupingBy(keyFunction));
> ```
>
> –ö–æ–¥ –Ω–∞–±–∞–≥–∞—Ç–æ —á–∏—Å—Ç—ñ—à–∏–π, –∫–æ—Ä–æ—Ç—à–∏–π —ñ –º–µ–Ω—à —Å—Ö–∏–ª—å–Ω–∏–π –¥–æ –ø–æ–º–∏–ª–æ–∫. `groupingBy` —î –±—ñ–ª—å—à —Å–µ–º–∞–Ω—Ç–∏—á–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–º –≤–∏–±–æ—Ä–æ–º –¥–ª—è –∑–∞–≤–¥–∞–Ω—å –≥—Ä—É–ø—É–≤–∞–Ω–Ω—è.

#### **üìå –©–æ –ø–µ—Ä–µ–≤—ñ—Ä—è—é—Ç—å:**

*–ó–¥–∞—Ç–Ω—ñ—Å—Ç—å –æ–±–∏—Ä–∞—Ç–∏ *–Ω–∞–π–∫—Ä–∞—â–∏–π* —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∑–∞–¥–∞—á—ñ. –ö–∞–Ω–¥–∏–¥–∞—Ç –ø–æ–≤–∏–Ω–µ–Ω —Ä–æ–∑—É–º—ñ—Ç–∏, —â–æ —Ö–æ—á–∞ `toMap` —î –≥–Ω—É—á–∫–∏–º, `groupingBy` —Å–ø–µ—Ü—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω–∏–π –¥–ª—è –≥—Ä—É–ø—É–≤–∞–Ω–Ω—è —ñ —î –∫—Ä–∞—â–∏–º –≤–∏–±–æ—Ä–æ–º —É —Ü—å–æ–º—É –≤–∏–ø–∞–¥–∫—É.*

* * *

### **14 ‚ùì –ü–∏—Ç–∞–Ω–Ω—è:**

–†–æ–∑–≥–ª—è–Ω—å—Ç–µ `toMap` –∑ `mergeFunction`. –Ø–∫—ñ –≤–∏–º–æ–≥–∏ –¥–æ —Ü—ñ—î—ó —Ñ—É–Ω–∫—Ü—ñ—ó –∑ —Ç–æ—á–∫–∏ –∑–æ—Ä—É –ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ—ó –æ–±—Ä–æ–±–∫–∏? ‚≠êÔ∏è‚≠êÔ∏è

> #### **üí¨ –í—ñ–¥–ø–æ–≤—ñ–¥—å:**
>
> –î–ª—è —Ç–æ–≥–æ, —â–æ–± `toMap` –∑ `mergeFunction` –∫–æ—Ä–µ–∫—Ç–Ω–æ –ø—Ä–∞—Ü—é–≤–∞–≤ —É –ø–∞—Ä–∞–ª–µ–ª—å–Ω–∏—Ö –ø–æ—Ç–æ–∫–∞—Ö (`parallelStream()`), `mergeFunction` –ø–æ–≤–∏–Ω–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—è–º **–∞—Å–æ—Ü—ñ–∞—Ç–∏–≤–Ω–æ—Å—Ç—ñ** —Ç–∞ **–≤—ñ–¥—Å—É—Ç–Ω–æ—Å—Ç—ñ —Å—Ç–∞–Ω—É**.
>
> * **–ê—Å–æ—Ü—ñ–∞—Ç–∏–≤–Ω—ñ—Å—Ç—å:** –†–µ–∑—É–ª—å—Ç–∞—Ç –Ω–µ –ø–æ–≤–∏–Ω–µ–Ω –∑–∞–ª–µ–∂–∞—Ç–∏ –≤—ñ–¥ –ø–æ—Ä—è–¥–∫—É –æ–±'—î–¥–Ω–∞–Ω–Ω—è.
>     `(a + b) + c` –ø–æ–≤–∏–Ω–Ω–æ –¥–æ—Ä—ñ–≤–Ω—é–≤–∞—Ç–∏ `a + (b + c)`. –û–ø–µ—Ä–∞—Ü—ñ—ó —è–∫-–æ—Ç `Integer::sum` —î –∞—Å–æ—Ü—ñ–∞—Ç–∏–≤–Ω–∏–º–∏. –ê –æ—Ç `(a, b) -> a - b` ‚Äî –Ω—ñ.
> * **–í—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å —Å—Ç–∞–Ω—É (stateless):** –§—É–Ω–∫—Ü—ñ—è –Ω–µ –ø–æ–≤–∏–Ω–Ω–∞ –∑–∞–ª–µ–∂–∞—Ç–∏ –≤—ñ–¥ –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö –∑–º—ñ–Ω–Ω–∏—Ö –∞–±–æ –∑–º—ñ–Ω—é–≤–∞—Ç–∏ —ó—Ö. –á—ó —Ä–µ–∑—É–ª—å—Ç–∞—Ç –º–∞—î –∑–∞–ª–µ–∂–∞—Ç–∏ –ª–∏—à–µ –≤—ñ–¥ –¥–≤–æ—Ö —ó—ó –≤—Ö—ñ–¥–Ω–∏—Ö –∞—Ä–≥—É–º–µ–Ω—Ç—ñ–≤.
>
> **–ß–æ–º—É —Ü–µ –≤–∞–∂–ª–∏–≤–æ:**
>
> –£ –ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ–º—É —Ä–µ–∂–∏–º—ñ `Stream API` –º–æ–∂–µ –æ–±—Ä–æ–±–ª—è—Ç–∏ —Ä—ñ–∑–Ω—ñ —á–∞—Å—Ç–∏–Ω–∏ –¥–∞–Ω–∏—Ö —É —Ä—ñ–∑–Ω–∏—Ö –ø–æ—Ç–æ–∫–∞—Ö, —Å—Ç–≤–æ—Ä—é—é—á–∏ –ø—Ä–æ–º—ñ–∂–Ω—ñ –º–∞–ø–∏. –ü–æ—Ç—ñ–º —Ü—ñ –º–∞–ø–∏ –æ–±'—î–¥–Ω—É—é—Ç—å—Å—è —Ä–∞–∑–æ–º. –Ø–∫—â–æ `mergeFunction` –Ω–µ —î –∞—Å–æ—Ü—ñ–∞—Ç–∏–≤–Ω–æ—é, –∫—ñ–Ω—Ü–µ–≤–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ –∑–∞–ª–µ–∂–∞—Ç–∏ –≤—ñ–¥ —Ç–æ–≥–æ, –≤ —è–∫–æ–º—É –ø–æ—Ä—è–¥–∫—É —Ü—ñ –ø—Ä–æ–º—ñ–∂–Ω—ñ –º–∞–ø–∏ –±—É–ª–∏ –æ–±'—î–¥–Ω–∞–Ω—ñ, —â–æ —Ä–æ–±–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–µ–ø–µ—Ä–µ–¥–±–∞—á—É–≤–∞–Ω–∏–º.

#### **üìå –©–æ –ø–µ—Ä–µ–≤—ñ—Ä—è—é—Ç—å:**

*–†–æ–∑—É–º—ñ–Ω–Ω—è –≤–∏–º–æ–≥ –¥–æ —Ñ—É–Ω–∫—Ü—ñ–π, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –≤ –ø–∞—Ä–∞–ª–µ–ª—å–Ω–∏—Ö –æ–±—á–∏—Å–ª–µ–Ω–Ω—è—Ö. –¶–µ –≥–ª–∏–±–æ–∫–µ –ø–∏—Ç–∞–Ω–Ω—è, —â–æ —Å—Ç–æ—Å—É—î—Ç—å—Å—è –ø–∞—Ä–∞–ª–µ–ª—ñ–∑–º—É —Ç–∞ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è.*

* * *

### **15 ‚ùì –ü–∏—Ç–∞–Ω–Ω—è:**

–°—Ç–≤–æ—Ä—ñ—Ç—å –≤–ª–∞—Å–Ω–∏–π `Collector`, —è–∫–∏–π –ø—Ä–∞—Ü—é—î –ø–æ–¥—ñ–±–Ω–æ –¥–æ `toMap`, –∞–ª–µ –∑–±–∏—Ä–∞—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –≤ `EnumMap`. ‚≠êÔ∏è‚≠êÔ∏è

> #### **üí¨ –í—ñ–¥–ø–æ–≤—ñ–¥—å:**
>
> –©–æ–± —Å—Ç–≤–æ—Ä–∏—Ç–∏ –≤–ª–∞—Å–Ω–∏–π –∫–æ–ª–µ–∫—Ç–æ—Ä, –ø–æ—Ç—Ä—ñ–±–Ω–æ —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å `Collector<T, A, R>`. –í—ñ–Ω –≤–∏–º–∞–≥–∞—î –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è —á–æ—Ç–∏—Ä—å–æ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤:
>
> 1. `supplier()`: —Å—Ç–≤–æ—Ä—é—î –ø–æ—Ä–æ–∂–Ω—ñ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ (–Ω–∞—à–∞ `EnumMap`).
> 2. `accumulator()`: –¥–æ–¥–∞—î –æ–¥–∏–Ω –µ–ª–µ–º–µ–Ω—Ç –ø–æ—Ç–æ–∫—É –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä.
> 3. `combiner()`: –æ–±'—î–¥–Ω—É—î –¥–≤–∞ –ø—Ä–æ–º—ñ–∂–Ω—ñ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏ (–¥–ª—è –ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ—ó –æ–±—Ä–æ–±–∫–∏).
> 4. `finisher()`: –≤–∏–∫–æ–Ω—É—î —Ñ—ñ–Ω–∞–ª—å–Ω–µ –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (–≤ –Ω–∞—à–æ–º—É –≤–∏–ø–∞–¥–∫—É –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–µ).
>
> #### **–ü—Ä–∏–∫–ª–∞–¥ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó:**
>
> –ü—Ä–∏–ø—É—Å—Ç–∏–º–æ, –∫–ª—é—á—ñ ‚Äî —Ü–µ `enum MyKey`.
>
> ```java
> public static <T, K extends Enum<K>, U> Collector<T, ?, EnumMap<K, U>> toEnumMap(
>     Function<? super T, ? extends K> keyMapper,
>     Function<? super T, ? extends U> valueMapper,
>     BinaryOperator<U> mergeFunction,
>     Class<K> enumKeyType
> ) {
>     return Collector.of(
>         () -> new EnumMap<>(enumKeyType), // 1. Supplier - —Å—Ç–≤–æ—Ä—é—î–º–æ –ø–æ—Ä–æ–∂–Ω—é EnumMap
>         (map, element) -> {               // 2. Accumulator - –¥–æ–¥–∞—î–º–æ –µ–ª–µ–º–µ–Ω—Ç
>             K key = keyMapper.apply(element);
>             U value = valueMapper.apply(element);
>             map.merge(key, value, mergeFunction);
>         },
>         (map1, map2) -> {                 // 3. Combiner - –æ–±'—î–¥–Ω—É—î–º–æ –º–∞–ø–∏
>             map2.forEach((key, value) -> map1.merge(key, value, mergeFunction));
>             return map1;
>         },
>         Collector.Characteristics.IDENTITY_FINISH // 4. Finisher - —Ñ—ñ–Ω–∞–ª—ñ–∑–∞—Ü—ñ—è –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–∞
>     );
> }
> ```
>
> –¢–∞–∫–∏–π –∫–æ–ª–µ–∫—Ç–æ—Ä –º–æ–∂–Ω–∞ –±—É–ª–æ –± –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –¥–ª—è –∑–±–æ—Ä—É –¥–∞–Ω–∏—Ö –≤ `EnumMap`, —â–æ —î –±—ñ–ª—å—à –µ—Ñ–µ–∫—Ç–∏–≤–Ω–∏–º –¥–ª—è –∫–ª—é—á—ñ–≤-–µ–Ω—É–º—ñ–≤, –Ω—ñ–∂ `HashMap`.

#### **üìå –©–æ –ø–µ—Ä–µ–≤—ñ—Ä—è—é—Ç—å:**

*–ï–∫—Å–ø–µ—Ä—Ç–Ω–µ –≤–æ–ª–æ–¥—ñ–Ω–Ω—è `Stream API`. –ó–¥–∞—Ç–Ω—ñ—Å—Ç—å –Ω–∞–ø–∏—Å–∞—Ç–∏ –≤–ª–∞—Å–Ω–∏–π `Collector` —î –æ–∑–Ω–∞–∫–æ—é –≥–ª–∏–±–æ–∫–æ–≥–æ —Ä–æ–∑—É–º—ñ–Ω–Ω—è —Ç–æ–≥–æ, —è–∫ –ø—Ä–∞—Ü—é—î –ø—Ä–æ—Ü–µ—Å –∑–±–æ—Ä—É –¥–∞–Ω–∏—Ö, —ñ —Å–≤—ñ–¥—á–∏—Ç—å –ø—Ä–æ —Ä—ñ–≤–µ–Ω—å Senior-—Ä–æ–∑—Ä–æ–±–Ω–∏–∫–∞.*

* * *
