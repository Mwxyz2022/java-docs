---
layout: default
title: "–ó–±–∏—Ä–∞–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤: Collectors.toMap()"
parent: "Stream API"
grand_parent: "Java 8"
nav_order: 9
---

# –ó–±–∏—Ä–∞–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤: Collectors.toMap()

* –∫–æ—Ä–æ—Ç–∫–∏–π –æ–ø–∏—Å: `Collectors.toMap()` ‚Äì —Ü–µ –∫–æ–ª–µ–∫—Ç–æ—Ä, —â–æ –¥–æ–∑–≤–æ–ª—è—î –∑—ñ–±—Ä–∞—Ç–∏ –µ–ª–µ–º–µ–Ω—Ç–∏ —Å—Ç—Ä—ñ–º—É —É `Map<K, V>`, –≤–∫–∞–∑—É—é—á–∏, —è–∫
  —Ñ–æ—Ä–º—É–≤–∞—Ç–∏ –∫–ª—é—á—ñ —Ç–∞ –∑–Ω–∞—á–µ–Ω–Ω—è. –ú–∞—î –ø–µ—Ä–µ–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–ª—è –æ–±—Ä–æ–±–∫–∏ –¥—É–±–ª—é—é—á–∏—Ö –∫–ª—é—á—ñ–≤ (`mergeFunction`) —Ç–∞ –¥–ª—è –≤–∫–∞–∑–∞–Ω–Ω—è —Ç–∏–ø—É
  `Map` (`mapSupplier`).
* –ø–æ–Ω—è—Ç—Ç—è: `Collectors.toMap()`, `keyMapper`, `valueMapper`, `mergeFunction` (–¥–ª—è –¥—É–±–ª—ñ–∫–∞—Ç—ñ–≤), `mapSupplier` (–¥–ª—è —Ç–∏–ø—É
  `Map`).
* –ø—Ä–∏–∫–ª–∞–¥–∏: `names.stream().collect(Collectors.toMap(name -> name, name -> name.length()))`,
  `names.stream().collect(Collectors.toMap(name -> name, name -> 1, Integer::sum))` (–æ–±—Ä–æ–±–∫–∞ –¥—É–±–ª—ñ–∫–∞—Ç—ñ–≤).
* –∫–ª—é—á–æ–≤—ñ –º–æ–º–µ–Ω—Ç–∏: –û–±–æ–≤'—è–∑–∫–æ–≤–æ –æ–±—Ä–æ–±–ª—è—Ç–∏ –¥—É–±–ª—ñ–∫–∞—Ç–∏ –∫–ª—é—á—ñ–≤, —è–∫—â–æ –≤–æ–Ω–∏ –º–æ–∂—É—Ç—å –≤–∏–Ω–∏–∫–Ω—É—Ç–∏, —ñ–Ω–∞–∫—à–µ ‚Äì `IllegalStateException`.
* —â–æ –≤–∞–∂–ª–∏–≤–æ –∑–Ω–∞—Ç–∏ –Ω–∞ —Å–ø—ñ–≤–±–µ—Å—ñ–¥—ñ: –Ø–∫ –∑—ñ–±—Ä–∞—Ç–∏ —É `Map`, –æ–±—Ä–æ–±–∫–∞ –¥—É–±–ª—ñ–∫–∞—Ç—ñ–≤.

#### **‚úÖ –û—Ñ—ñ—Ü—ñ–π–Ω–µ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è:**

**`Collectors.toMap()`** ‚Äî –º–µ—Ç–æ–¥ –∫–æ–ª–µ–∫—Ç–æ—Ä–∞ –∑ –ø–∞–∫–µ—Ç—É **`java.util.stream.Collectors`**, —è–∫–∏–π –¥–æ–∑–≤–æ–ª—è—î –∑—ñ–±—Ä–∞—Ç–∏ –µ–ª–µ–º–µ–Ω—Ç–∏
—Å—Ç—Ä—ñ–º—É —É **`Map<K, V>`**, –≤–∫–∞–∑—É—é—á–∏ —è–∫ —Å–∞–º–µ —Ñ–æ—Ä–º—É–≤–∞—Ç–∏ –∫–ª—é—á—ñ —Ç–∞ –∑–Ω–∞—á–µ–Ω–Ω—è.

#### **üß† –ü—Ä–æ—Å—Ç–∏–º–∏ —Å–ª–æ–≤–∞–º–∏:**

–¶–µ —è–∫ ‚Äú–ø–µ—Ä–µ—Ç–≤–æ—Ä–∏—Ç–∏ —Å–ø–∏—Å–æ–∫ –≤ –º–∞–ø—É‚Äù, —Å–∫–∞–∑–∞–≤—à–∏: ¬´–û—Ü–µ–π –µ–ª–µ–º–µ–Ω—Ç –±—É–¥–µ –∫–ª—é—á–µ–º, –∞ –æ—Ü–µ–π ‚Äî –∑–Ω–∞—á–µ–Ω–Ω—è–º¬ª. –ê–ª–µ —Ç—Ä–µ–±–∞ –±—É—Ç–∏ –æ–±–µ—Ä–µ–∂–Ω–∏–º —ñ–∑ –¥—É–±–ª—è–º–∏ –∫–ª—é—á—ñ–≤ ‚Äî Java –Ω–µ –ø—Ä–æ–±–∞—á–∞—î –¥–≤–æ—Ö –æ–¥–Ω–∞–∫–æ–≤–∏—Ö –∫–ª—é—á—ñ–≤ –±–µ–∑ –ø–æ—è—Å–Ω–µ–Ω—å.
---

## **2Ô∏è‚É£ –û—Å–Ω–æ–≤–Ω—ñ –≤–∏–¥–∏ / –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó / —Ç–∏–ø–∏**

üìä **–°–∏–≥–Ω–∞—Ç—É—Ä–∏ toMap():**


```java
// –ë–∞–∑–æ–≤–∞ –≤–µ—Ä—Å—ñ—è
toMap(Function keyMapper, Function valueMapper)

// –ó –æ–±—Ä–æ–±–∫–æ—é –∫–æ–Ω—Ñ–ª—ñ–∫—Ç—ñ–≤ –∫–ª—é—á—ñ–≤
toMap(Function keyMapper, Function valueMapper, BinaryOperator mergeFunction)

// –ó –≤–∫–∞–∑–∞–Ω–Ω—è–º —Ç–∏–ø—É Map
toMap(Function keyMapper, Function valueMapper, BinaryOperator mergeFunction, Supplier mapSupplier)
```
üìå **–ê—Ä–≥—É–º–µ–Ω—Ç–∏:**

* **`keyMapper`** ‚Äî —è–∫ –æ—Ç—Ä–∏–º–∞—Ç–∏ –∫–ª—é—á –∑ –µ–ª–µ–º–µ–Ω—Ç–∞
* **`valueMapper`** ‚Äî —è–∫ –æ—Ç—Ä–∏–º–∞—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è
* **`mergeFunction`** ‚Äî —â–æ —Ä–æ–±–∏—Ç–∏, —è–∫—â–æ –¥–≤–∞ –æ–¥–Ω–∞–∫–æ–≤–∏—Ö –∫–ª—é—á—ñ
* **`mapSupplier`** ‚Äî —è–∫—É —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—é Map —Å—Ç–≤–æ—Ä–∏—Ç–∏ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, **`TreeMap`**)

---

## **3Ô∏è‚É£ –ü–æ—è—Å–Ω–µ–Ω–Ω—è –Ω–∞ –ø–∞–ª—å—Ü—è—Ö (üí°)**

–£—è–≤–∏: –≤ —Ç–µ–±–µ —Å–ø–∏—Å–æ–∫ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤, —ñ —Ç–∏ —Ö–æ—á–µ—à —Å—Ç–≤–æ—Ä–∏—Ç–∏ –º–∞–ø—É **`—ñ–º‚Äô—è ‚Üí –æ—Ü—ñ–Ω–∫–∞`**.

–ê–ª–µ —è–∫—â–æ –¥–≤–∞ "–ê–Ω–¥—Ä—ñ—ó" –æ—Ç—Ä–∏–º–∞–ª–∏ —Ä—ñ–∑–Ω—ñ –±–∞–ª–∏ ‚Äî —â–æ —Ä–æ–±–∏—Ç–∏? –û—Ç —Ç—É—Ç —ñ –ø–æ—Ç—Ä—ñ–±–Ω–∞ merge-—Ñ—É–Ω–∫—Ü—ñ—è:

‚úîÔ∏è —á–∏ –±—Ä–∞—Ç–∏ –ø–µ—Ä—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç,

‚úîÔ∏è —á–∏ —Å—É–º—É–≤–∞—Ç–∏,

‚úîÔ∏è —á–∏ –±—Ä–∞—Ç–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–π.
---

## **4Ô∏è‚É£ –ö–æ—Ä–∏—Å–Ω—ñ –ø—Ä–∏–∫–ª–∞–¥–∏ (üß™)**


```java
// üìå –ü—Ä–æ—Å—Ç–µ –∑–±–∏—Ä–∞–Ω–Ω—è: —Å–ø–∏—Å–æ–∫ —ñ–º–µ–Ω ‚Üí –¥–æ–≤–∂–∏–Ω–∞ —ñ–º–µ–Ω—ñ
List<String> names = List.of("Anna", "Bob", "Alice");

Map<String, Integer> nameLengthMap = names.stream()
    .collect(Collectors.toMap(
        name -> name,              // keyMapper
        name -> name.length()      // valueMapper
    ));
```

```java
// ‚ö†Ô∏è –û–±—Ä–æ–±–∫–∞ –¥—É–±–ª—ñ–≤ –∫–ª—é—á—ñ–≤
List<String> names = List.of("Anna", "Bob", "Anna");

Map<String, Integer> nameCountMap = names.stream()
    .collect(Collectors.toMap(
        name -> name,
        name -> 1,
        Integer::sum               // mergeFunction: —Å—É–º—É—î–º–æ –ø–æ–≤—Ç–æ—Ä–∏
    ));
```

```java
// üå≤ –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è TreeMap
Map<String, Integer> sortedMap = names.stream()
    .collect(Collectors.toMap(
        name -> name,
        name -> name.length(),
        (a, b) -> b,               // –¥—É–±–ª—ñ–∫–∞—Ç–∏: –±–µ—Ä–µ–º–æ –æ—Å—Ç–∞–Ω–Ω—ñ–π
        TreeMap::new               // —Ç–∏–ø –º–∞–ø–∏
    ));
```
---

## **5Ô∏è‚É£ –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è (‚öñÔ∏è)**

|           –í–∏–ø–∞–¥–æ–∫            |                –©–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑—Ä–æ–±–∏—Ç–∏                |
|:----------------------------:|:-------------------------------------------------:|
|     **–£–Ω—ñ–∫–∞–ª—å–Ω—ñ –∫–ª—é—á—ñ**      |   –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π –ø—Ä–æ—Å—Ç—É –≤–µ—Ä—Å—ñ—é **`toMap(k, v)`**    |
| **–ú–æ–∂–ª–∏–≤—ñ –¥—É–±–ª—ñ–∫–∞—Ç–∏ –∫–ª—é—á—ñ–≤** |             –î–æ–¥–∞–π **`mergeFunction`**             |
| **–ü–æ—Ç—Ä—ñ–±–Ω–∞ —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–∞ Map**  | –î–æ–¥–∞–π **`mapSupplier`**, –Ω–∞–ø—Ä. **`TreeMap::new`** |

---

## **6Ô∏è‚É£ FAQ ‚Äî –ß–∞—Å—Ç—ñ –∑–∞–ø–∏—Ç–∞–Ω–Ω—è (‚ùì)**

#### **üîπ –ß–æ–º—É toMap() –º–æ–∂–µ –∫–∏–Ω—É—Ç–∏ –ø–æ–º–∏–ª–∫—É –ø—ñ–¥ —á–∞—Å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è?**

##### **üí¨ –í—ñ–¥–ø–æ–≤—ñ–¥—å:**

–Ø–∫—â–æ —É —Å—Ç—Ä—ñ–º—ñ –∑—É—Å—Ç—Ä—ñ—á–∞—é—Ç—å—Å—è –¥—É–±–ª—ñ–∫–∞—Ç–∏ –∫–ª—é—á—ñ–≤ —ñ –Ω–µ –≤–∫–∞–∑–∞–Ω–æ merge-—Ñ—É–Ω–∫—Ü—ñ—é, –±—É–¥–µ **`IllegalStateException`**. Java –Ω–µ –∑–Ω–∞—î,
—â–æ —Ä–æ–±–∏—Ç–∏ –∑ –¥—É–±–ª—è–º–∏ –±–µ–∑ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ–π.

---

#### **üîπ –ß–∏–º –≤—ñ–¥—Ä—ñ–∑–Ω—è—î—Ç—å—Å—è toMap() –≤—ñ–¥ groupingBy()?**

##### **üí¨ –í—ñ–¥–ø–æ–≤—ñ–¥—å:**

* **`toMap()`** ‚Üí –æ–¥–∏–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∞ –∫–ª—é—á
* **`groupingBy()`** ‚Üí —Å–ø–∏—Å–æ–∫ –∑–Ω–∞—á–µ–Ω—å –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –∫–ª—é—á–∞ (–≥—Ä—É–ø—É–≤–∞–Ω–Ω—è)

---

#### **üîπ –Ø–∫ –∑—ñ–±—Ä–∞—Ç–∏ Map, –¥–µ –∑–Ω–∞—á–µ–Ω–Ω—è–º —î —Å–ø–∏—Å–æ–∫?**

##### **üí¨ –í—ñ–¥–ø–æ–≤—ñ–¥—å:**

–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π **`groupingBy()`**:


```java
.stream().collect(Collectors.groupingBy(
    keyMapper,
    Collectors.mapping(valueMapper, Collectors.toList())
));
```
---

## **7Ô∏è‚É£ üß† –ú–Ω–µ–º–æ–Ω—ñ–∫–∞ –¥–ª—è –∑–∞–ø–∞–º‚Äô—è—Ç–æ–≤—É–≤–∞–Ω–Ω—è:**

**"toMap \= tell me how to get the Key, Value, Maybe Merge, Maybe Map"**  
–ó–∞–ø–∞–º‚Äô—è—Ç–∞–π 2+2 –≤–∞—Ä—ñ–∞–Ω—Ç–∏:

* **`toMap(k, v)`**
* **`toMap(k, v, merge)`**
* **`toMap(k, v, merge, mapSupplier)`**

---

## **8Ô∏è‚É£ –ü—ñ–¥—Å—É–º–æ–∫ (üü©)**

* **`Collectors.toMap()`** –¥–æ–∑–≤–æ–ª—è—î –∑—ñ–±—Ä–∞—Ç–∏ —Å—Ç—Ä—ñ–º —É Map.
* –û–±–æ–≤‚Äô—è–∑–∫–æ–≤–æ –≤—Ä–∞—Ö–æ–≤—É–π –¥—É–±–ª—ñ–∫–∞—Ç–∏ –∫–ª—é—á—ñ–≤ ‚Äî –∞–±–æ —É–Ω–∏–∫–∞—Ç–∏ —ó—Ö, –∞–±–æ –æ–±—Ä–æ–±–ª—è—Ç–∏ **`mergeFunction`**.
* –ó–∞ –ø–æ—Ç—Ä–µ–±–∏ –º–æ–∂–Ω–∞ —è–≤–Ω–æ –≤–∫–∞–∑–∞—Ç–∏ —Ç–∏–ø –º–∞–ø–∏ (**`TreeMap`**, **`LinkedHashMap`**).
* –ü–æ—Ç—É–∂–Ω–∏–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ—ó —Å–ø–∏—Å–∫—ñ–≤ —É —Å–ª–æ–≤–Ω–∏–∫–∏ / –∞—Å–æ—Ü—ñ–∞—Ç–∏–≤–Ω—ñ –º–∞—Å–∏–≤–∏.

---

**üîó –î–æ–¥–∞—Ç–∫–æ–≤–æ –¥–ª—è –ø–æ–≥–ª–∏–±–ª–µ–Ω–Ω—è:**

* [**Oracle JavaDoc: Collectors.toMap
  **](https://docs.oracle.com/javase/8/docs/api/java/util/stream/Collectors.html#toMap-java.util.function.Function-java.util.function.Function-)