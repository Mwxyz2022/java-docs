---
layout: default
title: "–ü–∏—Ç–∞–Ω–Ω—è –Ω–∞ —Å–ø—ñ–≤–±–µ—Å—ñ–¥—ñ –ø–æ Stream API"
parent: "Stream API"
grand_parent: "Java 8"
nav_order: 28
---

# –ü–∏—Ç–∞–Ω–Ω—è –Ω–∞ —Å–ø—ñ–≤–±–µ—Å—ñ–¥—ñ –ø–æ Stream API

* –∫–æ—Ä–æ—Ç–∫–∏–π –æ–ø–∏—Å: –û–≥–ª—è–¥ –Ω–∞–π–ø–æ–ø—É–ª—è—Ä–Ω—ñ—à–∏—Ö –ø–∏—Ç–∞–Ω—å –Ω–∞ —Ç–µ—Ö–Ω—ñ—á–Ω–∏—Ö —Å–ø—ñ–≤–±–µ—Å—ñ–¥–∞—Ö –ø–æ Stream API, —â–æ –æ—Ö–æ–ø–ª—é—é—Ç—å –±–∞–∑–æ–≤—ñ –∫–æ–Ω—Ü–µ–ø—Ü—ñ—ó,
  –æ—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è, –æ–±—Ä–æ–±–∫—É –≤–∏–Ω—è—Ç–∫—ñ–≤, –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å —Ç–∞ —Ç–∏–ø–æ–≤—ñ –ø–æ–º–∏–ª–∫–∏.
* –ø–æ–Ω—è—Ç—Ç—è: `map()` vs `flatMap()`, Lazy Evaluation, `parallelStream()`, Checked Exceptions —É –ª—è–º–±–¥–∞—Ö, –í–ª–∞—Å–Ω—ñ
  `Collectors`, `reduce()` vs `collect()`, `peek()`, `shared mutable state`.
* –ø—Ä–∏–∫–ª–∞–¥–∏: `Stream.of(...).flatMap(Arrays::stream)`, `stream.peek(System.out::println)`,
  `stream.parallel().forEach(list::add)` (–ø—Ä–æ–±–ª–µ–º–Ω–æ).
* –∫–ª—é—á–æ–≤—ñ –º–æ–º–µ–Ω—Ç–∏: –ó–¥–∞—Ç–Ω—ñ—Å—Ç—å –ø–æ—è—Å–Ω–∏—Ç–∏ –∫–ª—é—á–æ–≤—ñ –≤—ñ–¥–º—ñ–Ω–Ω–æ—Å—Ç—ñ, —Ä–æ–∑—É–º—ñ–Ω–Ω—è lazy evaluation, —Ä–∏–∑–∏–∫–∏ `parallelStream()`, –æ–±—Ä–æ–±–∫–∞
  –≤–∏–Ω—è—Ç–∫—ñ–≤.
* —â–æ –≤–∞–∂–ª–∏–≤–æ –∑–Ω–∞—Ç–∏ –Ω–∞ —Å–ø—ñ–≤–±–µ—Å—ñ–¥—ñ: –û—Å–Ω–æ–≤–Ω—ñ –ø–∞—Ç–µ—Ä–Ω–∏, –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è, –ø—Ä–æ–±–ª–µ–º–Ω—ñ –º—ñ—Å—Ü—è.

#### **‚úÖ –û—Ñ—ñ—Ü—ñ–π–Ω–µ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è:**

Stream API ‚Äî —Ü–µ —á–∞—Å—Ç–∏–Ω–∞ Java, —â–æ –Ω–∞–¥–∞—î —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–∏–π —Å—Ç–∏–ª—å –æ–±—Ä–æ–±–∫–∏ –∫–æ–ª–µ–∫—Ü—ñ–π –¥–∞–Ω–∏—Ö —á–µ—Ä–µ–∑ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü—ñ–π, —è–∫—ñ
–º–æ–∂–Ω–∞ –∫–æ–º–±—ñ–Ω—É–≤–∞—Ç–∏, —Ñ—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏, —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º—É–≤–∞—Ç–∏ —Ç–∞ –∑–±–∏—Ä–∞—Ç–∏.

#### **üß† –ü—Ä–æ—Å—Ç–∏–º–∏ —Å–ª–æ–≤–∞–º–∏:**

–ù–∞ —Å–ø—ñ–≤–±–µ—Å—ñ–¥—ñ –≤—ñ–¥ —Ç–µ–±–µ —á–∞—Å—Ç–æ —á–µ–∫–∞—é—Ç—å –Ω–µ –ø—Ä–æ—Å—Ç–æ "–∑–Ω–∞—é —Å—Ç—Ä—ñ–º–∏", –∞ –∑–¥–∞—Ç–Ω—ñ—Å—Ç—å –ø–æ—è—Å–Ω–∏—Ç–∏, –∫–æ–ª–∏ —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏, —è–∫ —É–Ω–∏–∫–∞—Ç–∏ –ø–æ–º–∏–ª–æ–∫ —ñ —è–∫ –æ–ø—Ç–∏–º—ñ–∑—É–≤–∞—Ç–∏ –∫–æ–¥. –í–∞–∂–ª–∏–≤–æ —Ä–æ–∑—É–º—ñ—Ç–∏ –¥–µ—Ç–∞–ª—ñ –ø—ñ–¥ –∫–∞–ø–æ—Ç–æ–º.
---

## **2Ô∏è‚É£ –û—Å–Ω–æ–≤–Ω—ñ –≤–∏–¥–∏ / –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó / —Ç–∏–ø–∏**

**üìä –ù–∞–π—á–∞—Å—Ç—ñ—à—ñ –ø–∏—Ç–∞–Ω–Ω—è —ñ —Ç–µ–º–∏ –Ω–∞ —ñ–Ω—Ç–µ—Ä–≤‚Äô—é:**

* **`map()`** vs **`flatMap()`** ‚Äî —Ä—ñ–∑–Ω–∏—Ü—è —ñ –ø—Ä–∏–∫–ª–∞–¥–∏
* **Lazy evaluation** ‚Äî —Å—Ç—Ä—ñ–º–∏ "–≤—ñ–¥–∫–ª–∞–¥–∞—é—Ç—å" –æ–±—á–∏—Å–ª–µ–Ω–Ω—è –¥–æ —Ç–µ—Ä–º—ñ–Ω–∞–ª—å–Ω–æ—ó –æ–ø–µ—Ä–∞—Ü—ñ—ó
* **`parallelStream()`** ‚Äî –∫–æ–ª–∏ –π–æ–≥–æ –¥—ñ–π—Å–Ω–æ –≤–∞—Ä—Ç–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏
* –í–∏–Ω—è—Ç–∫–∏ (**`try-catch`**) —É –ª—è–º–±–¥–∞-–≤–∏—Ä–∞–∑–∞—Ö
* –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –≤–ª–∞—Å–Ω–æ–≥–æ **`Collector`**
* **`reduce()`** vs **`collect()`**
* –ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å: **boxing**, **statefulness**, **combiner**

---

## **3Ô∏è‚É£ –ü–æ—è—Å–Ω–µ–Ω–Ω—è –Ω–∞ –ø–∞–ª—å—Ü—è—Ö (üí°)**

* **`map()`** –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î –µ–ª–µ–º–µ–Ω—Ç ‚Üí –æ–¥–∏–Ω –µ–ª–µ–º–µ–Ω—Ç
* **`flatMap()`** –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î –µ–ª–µ–º–µ–Ω—Ç ‚Üí –∫—ñ–ª—å–∫–∞ –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ (–ø–æ—Ç—ñ–∫), —ñ "—Å–ø–ª—é—â—É—î" —Ä–µ–∑—É–ª—å—Ç–∞—Ç


```java
List<String> words = Arrays.asList("hello", "world");
words.stream()
     .map(s -> s.split(""))        // Stream<String[]>
     .flatMap(Arrays::stream)      // Stream<String>
     .distinct()
     .forEach(System.out::print); // h e l o w r d
```
* **Lazy evaluation**: –∂–æ–¥–Ω–∞ intermediate-–æ–ø–µ—Ä–∞—Ü—ñ—è (**`map`**, **`filter`**, —Ç–æ—â–æ) –Ω–µ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è –±–µ–∑ —Ç–µ—Ä–º—ñ–Ω–∞–ª—å–Ω–æ—ó (*
  *`collect`**, **`forEach`**, **`reduce`**...)
* **`parallelStream()`** ‚â† –∑–∞–≤–∂–¥–∏ —à–≤–∏–¥—à–µ\! –í—ñ–Ω –ø—ñ–¥—Ö–æ–¥–∏—Ç—å –¥–ª—è:
    * –≤–µ–ª–∏–∫–∏—Ö –∫–æ–ª–µ–∫—Ü—ñ–π
    * –Ω–µ–∑–∞–ª–µ–∂–Ω–∏—Ö –æ–±—á–∏—Å–ª–µ–Ω—å
    * –≤—ñ–¥—Å—É—Ç–Ω–æ—Å—Ç—ñ side-effects

---

## **4Ô∏è‚É£ –ö–æ—Ä–∏—Å–Ω—ñ –ø—Ä–∏–∫–ª–∞–¥–∏ (üß™)**


```java
// map vs flatMap
Stream.of("java", "stream")
      .map(s -> s.chars()) // Stream<IntStream>
      .forEach(System.out::println);

Stream.of("java", "stream")
      .flatMapToInt(String::chars) // IntStream
      .forEach(c -> System.out.print((char)c));
```

```java
// –û–±—Ä–æ–±–∫–∞ –≤–∏–Ω—è—Ç–∫—ñ–≤ —É –ª—è–º–±–¥—ñ
list.stream()
    .map(item -> {
        try {
            return riskyOperation(item);
        } catch (Exception e) {
            return defaultValue;
        }
    })
    .forEach(System.out::println);
```

```java
// –í–ª–∞—Å–Ω–∏–π –∫–æ–ª–µ–∫—Ç–æ—Ä -- –∑–±–∏—Ä–∞–Ω–Ω—è –≤ —Ä—è–¥–æ–∫ —ñ–∑ –¥—É–∂–∫–∞–º–∏
Collector<String, ?, String> bracketedJoiner =
    Collector.of(
        () -> new StringBuilder("["),
        (sb, s) -> sb.append(s).append(","),
        (sb1, sb2) -> sb1.append(sb2),
        sb -> {
            if (sb.length() > 1) sb.setLength(sb.length() - 1); // remove last comma
            return sb.append("]").toString();
        }
    );
List.of("a", "b", "c").stream().collect(bracketedJoiner); // "[a,b,c]"
```
---

## **5Ô∏è‚É£ –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è (‚öñÔ∏è)**

|                 –¢–µ–º–∞                 |                             –ö–ª—é—á–æ–≤—ñ –≤—ñ–¥–º—ñ–Ω–Ω–æ—Å—Ç—ñ                             |
|:------------------------------------:|:---------------------------------------------------------------------------:|
|      **`map()` vs `flatMap()`**      |              map ‚Üí –æ–¥–∏–Ω-–¥–æ-–æ–¥–Ω–æ–≥–æ, flatMap ‚Üí –±–∞–≥–∞—Ç–æ-–¥–æ-–æ–¥–Ω–æ–≥–æ               |
|    **`reduce()` vs `collect()`**     | reduce ‚Äî —Å–∫–æ—Ä–æ—á–µ–Ω–Ω—è –¥–æ –æ–¥–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–Ω—è; collect ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥—å-—è–∫–æ—ó —Ñ–æ—Ä–º–∏ |
| **`stream()` vs `parallelStream()`** | stream ‚Äî –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–∞ –æ–±—Ä–æ–±–∫–∞, parallelStream ‚Äî –ø–∞—Ä–∞–ª–µ–ª—å–Ω–∞ —á–µ—Ä–µ–∑ ForkJoinPool |

---

## **6Ô∏è‚É£ FAQ ‚Äî –ß–∞—Å—Ç—ñ –∑–∞–ø–∏—Ç–∞–Ω–Ω—è (‚ùì)**

#### **üîπ –ü–∏—Ç–∞–Ω–Ω—è:**

–£ —á–æ–º—É —Ä—ñ–∑–Ω–∏—Ü—è –º—ñ–∂ **`map()`** —Ç–∞ **`flatMap()`**?

##### **üí¨ –í—ñ–¥–ø–æ–≤—ñ–¥—å:**

**`map()`** –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î –∫–æ–∂–µ–Ω –µ–ª–µ–º–µ–Ω—Ç —É –Ω–æ–≤–∏–π, **`flatMap()`** ‚Äî –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î –∫–æ–∂–µ–Ω —É –ø–æ—Ç—ñ–∫ —ñ "—Å–ø–ª—é—â—É—î" —ó—Ö —É –æ–¥–∏–Ω –ø–æ—Ç—ñ–∫.

---

#### **üîπ –ü–∏—Ç–∞–Ω–Ω—è:**

–ö–æ–ª–∏ **`parallelStream()`** –º–æ–∂–µ –±—É—Ç–∏ —à–∫—ñ–¥–ª–∏–≤–∏–º?

##### **üí¨ –í—ñ–¥–ø–æ–≤—ñ–¥—å:**

–ö–æ–ª–∏ —î side-effects, shared mutable state –∞–±–æ –º–∞–ª–∏–π –æ–±—Å—è–≥ –¥–∞–Ω–∏—Ö ‚Äî —Ü–µ –º–æ–∂–µ –ø–æ–≥—ñ—Ä—à–∏—Ç–∏ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å.

---

#### **üîπ –ü–∏—Ç–∞–Ω–Ω—è:**

–Ø–∫ –æ–±—Ä–æ–±–∏—Ç–∏ checked exception —É —Å—Ç—Ä—ñ–º—ñ?

##### **üí¨ –í—ñ–¥–ø–æ–≤—ñ–¥—å:**

–û–±–≥–æ—Ä–Ω—É—Ç–∏ –ª–æ–≥—ñ–∫—É —É **`try-catch`** –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –ª—è–º–±–¥–∏ –∞–±–æ –≤–∏–Ω–µ—Å—Ç–∏ –æ–±—Ä–æ–±–∫—É —É –æ–∫—Ä–µ–º–∏–π –º–µ—Ç–æ–¥.

---

#### **üîπ –ü–∏—Ç–∞–Ω–Ω—è:**

–Ø–∫ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –≤–ª–∞—Å–Ω–∏–π **`Collector`**?

##### **üí¨ –í—ñ–¥–ø–æ–≤—ñ–¥—å:**

–í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ **`Collector.of(supplier, accumulator, combiner, finisher)`** ‚Äî —Ü–µ –¥–æ–∑–≤–æ–ª—è—î —Å—Ç–≤–æ—Ä–∏—Ç–∏ –≥–Ω—É—á–∫–∏–π –º–µ—Ö–∞–Ω—ñ–∑–º
–∑–±–∏—Ä–∞–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É.

---

## **7Ô∏è‚É£ üß† –ú–Ω–µ–º–æ–Ω—ñ–∫–∞ –¥–ª—è –∑–∞–ø–∞–º‚Äô—è—Ç–æ–≤—É–≤–∞–Ω–Ω—è:**

**MAP-FLAT-TRY-PAR-COLLECT**

* **MAP** vs **FLAT** ‚Äî —Ä—ñ–∑–Ω–∏—Ü—è —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ–π
* **TRY** ‚Äî –æ–±—Ä–æ–±–∫–∞ –≤–∏–Ω—è—Ç–∫—ñ–≤
* **PAR** ‚Äî –ø–∞—Ä–∞–ª–µ–ª—å–Ω—ñ—Å—Ç—å ‚â† –∑–∞–≤–∂–¥–∏ –¥–æ–±—Ä–∞
* **COLLECT** ‚Äî –∑–±—ñ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É (–≤–ª–∞—Å–Ω—ñ –∫–æ–ª–µ–∫—Ç–æ—Ä–∏ —Ç–µ–∂)

---

## **8Ô∏è‚É£ –ü—ñ–¥—Å—É–º–æ–∫ (üü©)**

* –†–æ–∑—É–º—ñ–Ω–Ω—è **`map()`** vs **`flatMap()`** ‚Äî –º–∞—Å—Ç-—Ö–µ–≤
* **`lazy evaluation`** –¥–æ–∑–≤–æ–ª—è—î —Å—Ç—Ä—ñ–º–∞–º –±—É—Ç–∏ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–∏–º–∏
* **`parallelStream()`** –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –æ–±–µ—Ä–µ–∂–Ω–æ
* –í–∏–Ω—è—Ç–∫–∏ –ø–æ—Ç—Ä—ñ–±–Ω–æ –æ–±—Ä–æ–±–ª—è—Ç–∏ –≤—Ä—É—á–Ω—É —É —Å—Ç—Ä—ñ–º–∞—Ö
* –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –≤–ª–∞—Å–Ω–∏—Ö –∫–æ–ª–µ–∫—Ç–æ—Ä—ñ–≤ –≤—ñ–¥–∫—Ä–∏–≤–∞—î –Ω–æ–≤—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ
* –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è —Å—Ç—Ä—ñ–º—ñ–≤ –≤–∏–º–∞–≥–∞—î —Ä–æ–∑—É–º—ñ–Ω–Ω—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ —Ç–∞ –æ–±–º–µ–∂–µ–Ω—å