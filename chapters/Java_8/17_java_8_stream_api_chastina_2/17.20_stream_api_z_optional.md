---
layout: default
title: "Stream API –∑ Optional"
parent: "Stream API"
grand_parent: "Java 8"
nav_order: 20
---

# Stream API –∑ Optional

* –∫–æ—Ä–æ—Ç–∫–∏–π –æ–ø–∏—Å: –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è `Optional` –∑ Stream API –¥–æ–∑–≤–æ–ª—è—î –æ–±'—î–¥–Ω–∞—Ç–∏ –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω—É –æ–±—Ä–æ–±–∫—É –ø–æ—Ç–æ–∫—ñ–≤ —ñ–∑ –±–µ–∑–ø–µ—á–Ω–æ—é —Ä–æ–±–æ—Ç–æ—é –∑ –≤—ñ–¥—Å—É—Ç–Ω—ñ–º–∏ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏. –ó Java 9, `Optional` –º–∞—î –º–µ—Ç–æ–¥ `stream()`, —â–æ –¥–æ–∑–≤–æ–ª—è—î –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –∑ –Ω–∏–º —è–∫ –∑ –ø–æ—Ç–æ–∫–æ–º –∑ 0 –∞–±–æ 1 –µ–ª–µ–º–µ–Ω—Ç–∞.
* –ø–æ–Ω—è—Ç—Ç—è: `Optional.stream()` (–∑ Java 9), `Stream.ofNullable()` (–∑ Java 9), `flatMap(Optional::stream)`.
* –ø—Ä–∏–∫–ª–∞–¥–∏: `Optional.of("Alice").stream().collect(...)`, `Stream.ofNullable(null)` (—Å—Ç–≤–æ—Ä–∏—Ç—å –ø–æ—Ä–æ–∂–Ω—ñ–π —Å—Ç—Ä—ñ–º), `list.stream().flatMap(Optional::stream)` (—Ä–æ–∑–ø–∞–∫–æ–≤—É—î –∑–Ω–∞—á–µ–Ω–Ω—è –∑ `Optional` —É —Å—Ç—Ä—ñ–º—ñ).
* –∫–ª—é—á–æ–≤—ñ –º–æ–º–µ–Ω—Ç–∏: –î–æ–∑–≤–æ–ª—è—î —É–Ω–∏–∫–∞—Ç–∏ `NullPointerException` —Ç–∞ `if`-–ø–µ—Ä–µ–≤—ñ—Ä–æ–∫ —É Stream-–ø–∞–π–ø–ª–∞–π–Ω–∞—Ö, —Ä–æ–±–∏—Ç—å –∫–æ–¥ —á–∏—Å—Ç—ñ—à–∏–º.
* —â–æ –≤–∞–∂–ª–∏–≤–æ –∑–Ω–∞—Ç–∏ –Ω–∞ —Å–ø—ñ–≤–±–µ—Å—ñ–¥—ñ: –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è Stream —Ç–∞ Optional, `flatMap` –¥–ª—è "—Ä–æ–∑–ø–∞–∫–æ–≤–∫–∏".

### **‚úÖ –û—Ñ—ñ—Ü—ñ–π–Ω–µ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è:**

–Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è **`Stream`** —Ç–∞ **`Optional`** –≤ Java –¥–æ–∑–≤–æ–ª—è—î –æ–±'—î–¥–Ω–∞—Ç–∏ –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω—É –æ–±—Ä–æ–±–∫—É –ø–æ—Ç–æ–∫—ñ–≤ —ñ–∑ –±–µ–∑–ø–µ—á–Ω–æ—é —Ä–æ–±–æ—Ç–æ—é –∑ –≤—ñ–¥—Å—É—Ç–Ω—ñ–º–∏ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏ —á–µ—Ä–µ–∑ **`Optional`**. –ü–æ—á–∏–Ω–∞—é—á–∏ –∑ Java 9, **`Optional`** –º–∞—î –º–µ—Ç–æ–¥ **`stream()`**, —â–æ –¥–∞—î –∑–º–æ–≥—É –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –∑ –Ω–∏–º —è–∫ –∑ –ø–æ—Ç–æ–∫–æ–º.

### **üß† –ü—Ä–æ—Å—Ç–∏–º–∏ —Å–ª–æ–≤–∞–º–∏:**

–¶–µ "–º—ñ—Å—Ç–æ–∫" –º—ñ–∂ **Optional**, —è–∫–∏–π –º–æ–∂–µ –º—ñ—Å—Ç–∏—Ç–∏ –∞–±–æ –Ω–µ –º—ñ—Å—Ç–∏—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è, —Ç–∞ **Stream**, —è–∫–∏–π –æ–ø–µ—Ä—É—î –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—é –¥–∞–Ω–∏—Ö. –ó–∞–≤–¥—è–∫–∏ **`Optional.stream()`** –º–æ–∂–Ω–∞ –≤–ø–∏—Å–∞—Ç–∏ Optional —É –ø–æ—Ç—ñ–∫ —è–∫ –µ–ª–µ–º–µ–Ω—Ç (–∞–±–æ –Ω–µ –≤–∫–ª—é—á–∞—Ç–∏, —è–∫—â–æ –ø–æ—Ä–æ–∂–Ω—ñ–π) ‚Äî –±–µ–∑ if'—ñ–≤, –ø—Ä–æ—Å—Ç–æ –µ–ª–µ–≥–∞–Ω—Ç–Ω–æ

---

## üìä **–ö–ª—é—á–æ–≤—ñ –º–µ—Ç–æ–¥–∏:**

* **`Stream.ofNullable(value)`** ‚Äî —Å—Ç–≤–æ—Ä—é—î –ø–æ—Ç—ñ–∫ –∑ –æ–¥–Ω–æ–≥–æ –µ–ª–µ–º–µ–Ω—Ç–∞ –∞–±–æ –ø–æ—Ä–æ–∂–Ω—ñ–π.
* **`Optional.stream()`** ‚Äî –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î Optional —É –ø–æ—Ç—ñ–∫ –∑ 0 –∞–±–æ 1 –µ–ª–µ–º–µ–Ω—Ç–∞.
* **`flatMap(Optional::stream)`** ‚Äî "—Ä–æ–∑–ø–∞–∫–æ–≤—É—î" Optional –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –ø–æ—Ç–æ–∫—É.
* **`filter(...), map(...), orElse(...)`** ‚Äî –º–æ–∂–Ω–∞ –æ–±'—î–¥–Ω—É–≤–∞—Ç–∏ –∑—ñ —Å—Ç—Ä—ñ–º–∞–º–∏.

---

## **–ü–æ—è—Å–Ω–µ–Ω–Ω—è –Ω–∞ –ø–∞–ª—å—Ü—è—Ö (üí°)**

–£—è–≤–∏: –≤ —Ç–µ–±–µ —î —Å–ø–∏—Å–æ–∫ Optional'—ñ–≤, —ñ —Ç–∏ —Ö–æ—á–µ—à –≤–∏—Ç—è–≥–Ω—É—Ç–∏ –≤—Å—ñ –∑–Ω–∞—á–µ–Ω–Ω—è.  

–ú–æ–∂–Ω–∞:

1. –ü–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏ **`.isPresent()`**?
2. –î—ñ—Å—Ç–∞—Ç–∏ **`.get()`**?

üëé –ù–µ–±–µ–∑–ø–µ—á–Ω–æ –π –Ω—É–¥–Ω–æ.

–ö—Ä–∞—â–µ:

‚úÖ **`flatMap(Optional::stream)`** ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø—Ä–∏–±–∏—Ä–∞—î –ø–æ—Ä–æ–∂–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è —Ç–∞ "—Ä–æ–∑–≥–æ—Ä—Ç–∞—î" –∑–Ω–∞—á—É—â—ñ.

---

## **–ö–æ—Ä–∏—Å–Ω—ñ –ø—Ä–∏–∫–ª–∞–¥–∏ (üß™)**

### **üîπ `Optional.stream()` ‚Äî Java 9+**

```java
Optional<String> maybeName = Optional.of("Alice");

List<String> names = maybeName.stream().collect(Collectors.toList());
// --> ["Alice"]
```

---

### **üîπ `Stream.ofNullable(...)` ‚Äî Java 9+**

```java
Stream<String> stream = Stream.ofNullable(null);
// --> –ø–æ—Ä–æ–∂–Ω—ñ–π –ø–æ—Ç—ñ–∫
```

---

### **üîπ `flatMap(Optional::stream)` ‚Äî –≤–∏—Ç—è–≥ –∑–Ω–∞—á–µ–Ω—å —ñ–∑ Optional —É —Å—Ç—Ä—ñ–º—ñ**

```java
List<Optional<String>> list = List.of(Optional.of("A"), Optional.empty(), Optional.of("B"));

List<String> result = list.stream()
    .flatMap(Optional::stream)
    .collect(Collectors.toList());
// --> ["A", "B"]
```

---

### **üîπ –ö–æ–º–±—ñ–Ω—É–≤–∞–Ω–Ω—è: –æ–±—Ä–æ–±–∫–∞ Nullable –∑–Ω–∞—á–µ–Ω—å —á–µ—Ä–µ–∑ Stream**

```java
Stream.ofNullable(getUser())
    .flatMap(user -> Stream.ofNullable(user.getName()))
    .forEach(System.out::println);
```

---

## **–ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è (‚öñÔ∏è)**

|              –ú–µ—Ç–æ–¥              |                  –©–æ —Ä–æ–±–∏—Ç—å                  |           –ü–µ—Ä–µ–≤–∞–≥–∏            |
|:-------------------------------:|:-------------------------------------------:|:-----------------------------:|
|     **`Optional.stream()`**     |    –ü–æ—Ç—ñ–∫ –∑ 0 –∞–±–æ 1 –µ–ª–µ–º–µ–Ω—Ç–æ–º —ñ–∑ Optional    |       –ü—Ä–æ—Å—Ç–∞ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è       |
|    **`Stream.ofNullable()`**    | –ü–æ—Ç—ñ–∫ –∑ 0 –∞–±–æ 1 –µ–ª–µ–º–µ–Ω—Ç–æ–º –∑ null-–ø–µ—Ä–µ–≤—ñ—Ä–∫–æ—é |    –ó—Ä—É—á–Ω–æ –∑–∞–º—ñ—Å—Ç—å if-null     |
| **`flatMap(Optional::stream)`** |    –í–∏—Ç—è–≥—É—î –∑–Ω–∞—á–µ–Ω–Ω—è –∑ Optional —É –ø–æ—Ç–æ—Ü—ñ     | –ü—Ä–∏–±–∏—Ä–∞—î **`empty`** –∑–Ω–∞—á–µ–Ω–Ω—è |

---

## **FAQ ‚Äî –ß–∞—Å—Ç—ñ –∑–∞–ø–∏—Ç–∞–Ω–Ω—è (‚ùì)**

### **‚ùì –ü–∏—Ç–∞–Ω–Ω—è:**

 –ß–æ–º—É `Optional.stream()` –∑ º—è–≤–∏–≤—Å—è —Ç—ñ–ª—å–∫–∏ –≤ Java 9?

### **üí¨ –í—ñ–¥–ø–æ–≤—ñ–¥—å:**

–¶–µ –±—É–ª–æ –ª–æ–≥—ñ—á–Ω–µ –¥–æ–ø–æ–≤–Ω–µ–Ω–Ω—è –¥–ª—è –∫—Ä–∞—â–æ—ó —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó –∑ Stream API, —è–∫–µ –¥–æ–∑–≤–æ–ª—è—î –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –∑ Optional —Ç–∞–∫ —Å–∞–º–æ –≥–Ω—É—á–∫–æ, —è–∫ –∑ –∫–æ–ª–µ–∫—Ü—ñ—è–º–∏.

---

### **‚ùì –ü–∏—Ç–∞–Ω–Ω—è:**

 –ö–æ–ª–∏ –∫—Ä–∞—â–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ `Stream.ofNullable()`?

### **üí¨ –í—ñ–¥–ø–æ–≤—ñ–¥—å:**

–ö–æ–ª–∏ —Ç–∏ —Ö–æ—á–µ—à —É–Ω–∏–∫–Ω—É—Ç–∏ **`null`**\-–ø–µ—Ä–µ–≤—ñ—Ä–æ–∫ —ñ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –ø–æ—Ç—ñ–∫ –∑ –æ–¥–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–Ω—è –∞–±–æ –ø–æ—Ä–æ–∂–Ω—ñ–π. –ß–∞—Å—Ç–æ –∫–æ—Ä–∏—Å–Ω–æ –≤ –ª–∞–Ω—Ü—é–≥–∞—Ö –æ–±—Ä–æ–±–∫–∏, –¥–µ –∑–Ω–∞—á–µ–Ω–Ω—è –º–æ–∂–µ –±—É—Ç–∏ **`null`**.

---

### **‚ùì –ü–∏—Ç–∞–Ω–Ω—è:**

 –£ —á–æ–º—É —Å–∏–ª–∞ `flatMap(Optional::stream)`?

### **üí¨ –í—ñ–¥–ø–æ–≤—ñ–¥—å:**

–¶–µ –±–µ–∑–ø–µ—á–Ω–∏–π —Å–ø–æ—Å—ñ–± **–≤–∏—Ç—è–≥–Ω—É—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è –∑ Optional'—ñ–≤ —É —Å—Ç—Ä—ñ–º—ñ**, —É–Ω–∏–∫–∞—é—á–∏ null/empty, –±–µ–∑ if-—ñ–≤ —ñ get-—ñ–≤.

---

## **üß† –ú–Ω–µ–º–æ–Ω—ñ–∫–∞ –¥–ª—è –∑–∞–ø–∞–º‚Äô—è—Ç–æ–≤—É–≤–∞–Ω–Ω—è:**

**"–û–°–§ ‚Äî Optional, Stream, FlatMap"**  
üîó –©–æ–± –∑–≤‚Äô—è–∑–∞—Ç–∏ Optional —Ç–∞ Stream:

* **O**ptional -->
* **`.**S**tream()`** -->
* **`.**F**latMap(Optional::stream)`** --> –æ—Ç—Ä–∏–º–∞–π –ª–∏—à–µ —Ç—ñ, —â–æ —â–æ—Å—å –º—ñ—Å—Ç—è—Ç—å.

---

## **üü© –ü—ñ–¥—Å—É–º–æ–∫:**

* **`Optional.stream()`** ‚Äî —á—É–¥–æ–≤–∏–π —Å–ø–æ—Å—ñ–± –≤–∫–ª—é—á–∏—Ç–∏ Optional —É —Å—Ç—Ä—ñ–º –±–µ–∑ if-—ñ–≤.
* **`Stream.ofNullable()`** ‚Äî –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ **`null`**.
* **`flatMap(Optional::stream)`** ‚Äî –¥–æ–∑–≤–æ–ª—è—î —Ä–æ–∑–ø–∞–∫–æ–≤—É–≤–∞—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è –∑ Optional —É –∫–æ–ª–µ–∫—Ü—ñ—è—Ö.
* –í–∞–∂–ª–∏–≤–æ –∑–Ω–∞—Ç–∏: –∑ Java 9 —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è Optional \+ Stream —Å—Ç–∞–ª–∞ –ø—Ä–∏—Ä–æ–¥–Ω–æ—é –π –¥—É–∂–µ –ø–æ—Ç—É–∂–Ω–æ—é.

---

### **üîó –î–æ–¥–∞—Ç–∫–æ–≤—ñ –¥–∂–µ—Ä–µ–ª–∞:**

* [**Official JavaDocs ‚Äî Optional.stream()**](https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Optional.html#stream\(\))
