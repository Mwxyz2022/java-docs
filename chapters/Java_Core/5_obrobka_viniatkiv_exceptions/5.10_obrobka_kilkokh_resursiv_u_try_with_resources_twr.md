---
layout: default
title: "–û–±—Ä–æ–±–∫–∞ –∫—ñ–ª—å–∫–æ—Ö —Ä–µ—Å—É—Ä—Å—ñ–≤ —É try-with-resources (TWR)"
parent: "–û–±—Ä–æ–±–∫–∞ –≤–∏–Ω—è—Ç–∫—ñ–≤ (Exceptions)"
grand_parent: "Java Core"
nav_order: 10
---

# –û–±—Ä–æ–±–∫–∞ –∫—ñ–ª—å–∫–æ—Ö —Ä–µ—Å—É—Ä—Å—ñ–≤ —É try-with-resources (TWR)

* –∫–æ—Ä–æ—Ç–∫–∏–π –æ–ø–∏—Å: –£ `try-with-resources` –º–æ–∂–Ω–∞ –≤—ñ–¥–∫—Ä–∏–≤–∞—Ç–∏ –∫—ñ–ª—å–∫–∞ —Ä–µ—Å—É—Ä—Å—ñ–≤ –æ–¥–Ω–æ—á–∞—Å–Ω–æ, —Ä–æ–∑–¥—ñ–ª—è—é—á–∏ —ó—Ö –∫—Ä–∞–ø–∫–æ—é –∑ –∫–æ–º–æ—é. –†–µ—Å—É—Ä—Å–∏ –∑–∞–∫—Ä–∏–≤–∞—é—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —É –∑–≤–æ—Ä–æ—Ç–Ω–æ–º—É –ø–æ—Ä—è–¥–∫—É, –≤ —è–∫–æ–º—É –±—É–ª–∏ –≤—ñ–¥–∫—Ä–∏—Ç—ñ.

* –ø–æ–Ω—è—Ç—Ç—è: –ö—ñ–ª—å–∫–∞ —Ä–µ—Å—É—Ä—Å—ñ–≤ —É TWR, –ø–æ—Ä—è–¥–æ–∫ –∑–∞–∫—Ä–∏—Ç—Ç—è.

* –ø—Ä–∏–∫–ª–∞–¥–∏: `try (BufferedReader r1 = ...; FileWriter w1 = ...) { ... }`.

* –∫–ª—é—á–æ–≤—ñ –º–æ–º–µ–Ω—Ç–∏: –†–µ—Å—É—Ä—Å–∏ –∑–∞–∫—Ä–∏–≤–∞—é—Ç—å—Å—è —É –∑–≤–æ—Ä–æ—Ç–Ω–æ–º—É –ø–æ—Ä—è–¥–∫—É –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è. –ü—Ä–∏ –≤–∏–Ω—è—Ç–∫–∞—Ö —É `close()` –º–µ—Ç–æ–¥–∞—Ö, –≤–æ–Ω–∏ –¥–æ–¥–∞—é—Ç—å—Å—è —è–∫ `suppressed exceptions`.

* —â–æ –≤–∞–∂–ª–∏–≤–æ –∑–Ω–∞—Ç–∏ –Ω–∞ —Å–ø—ñ–≤–±–µ—Å—ñ–¥—ñ: –Ø–∫ –≤—ñ–¥–∫—Ä–∏–≤–∞—Ç–∏ –∫—ñ–ª—å–∫–∞ —Ä–µ—Å—É—Ä—Å—ñ–≤, –ø–æ—Ä—è–¥–æ–∫ –∑–∞–∫—Ä–∏—Ç—Ç—è, `suppressed exceptions`.

### **‚úÖ –û—Ñ—ñ—Ü—ñ–π–Ω–µ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è:**

```java
try (
    ResourceType1 r1 = new ResourceType1(...);
    ResourceType2 r2 = new ResourceType2(...)
) {
    // —Ä–æ–±–æ—Ç–∞ –∑ r1 —ñ r2
} catch (Exception e) {
    // –æ–±—Ä–æ–±–∫–∞ –ø–æ–º–∏–ª–æ–∫
}
```

### **üß† –ü—Ä–æ—Å—Ç–∏–º–∏ —Å–ª–æ–≤–∞–º–∏:**

–û–≥–æ–ª–æ—à—É–π —Ä–µ—Å—É—Ä—Å–∏ —á–µ—Ä–µ–∑ **`;`**, —ñ Java —Å–∞–º–∞ –∫–µ—Ä—É—î —ó—Ö–Ω—ñ–º –∂–∏—Ç—Ç—î–≤–∏–º —Ü–∏–∫–ª–æ–º.

#### **‚úîÔ∏è –ü—Ä–∏–∫–ª–∞–¥:**

```java
try (
    BufferedReader reader1 = new BufferedReader(new FileReader("file1.txt"));
    BufferedReader reader2 = new BufferedReader(new FileReader("file2.txt"))
) {
    System.out.println(reader1.readLine());
    System.out.println(reader2.readLine());
} catch (IOException e) {
    System.out.println("–°—Ç–∞–ª–∞—Å—è –ø–æ–º–∏–ª–∫–∞: " + e.getMessage());
}
```

---

## **–û—Å–Ω–æ–≤–Ω–µ**

| –î—ñ—è | –ü–æ—Ä—è–¥–æ–∫ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è |
| :---: | :---: |
| **–í—ñ–¥–∫—Ä–∏–≤–∞—é—Ç—å—Å—è** | r1 -> r2 -> r3 |
| **–ó–∞–∫—Ä–∏–≤–∞—é—Ç—å—Å—è** | r3 -> r2 -> r1 *(–æ–±–µ—Ä–Ω–µ–Ω–æ)* |

üìå –¶–µ –∫—Ä–∏—Ç–∏—á–Ω–æ, —è–∫—â–æ —Ä–µ—Å—É—Ä—Å–∏ –∑–∞–ª–µ–∂–∞—Ç—å –æ–¥–∏–Ω –≤—ñ–¥ –æ–¥–Ω–æ–≥–æ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥: **`BufferedWriter`** -> **`OutputStreamWriter`** -> **`FileOutputStream`**).

---

## **–©–æ –±—É–¥–µ, —è–∫—â–æ –ø—Ä–∏ –∑–∞–∫—Ä–∏—Ç—Ç—ñ –≤–∏–Ω–∏–∫–∞—é—Ç—å –≤–∏–Ω—è—Ç–∫–∏?**

üìå –Ø–∫—â–æ –∫—ñ–ª—å–∫–∞ —Ä–µ—Å—É—Ä—Å—ñ–≤ –∫–∏–¥–∞—é—Ç—å –≤–∏–Ω—è—Ç–∫–∏ —É **`close()`**, Java:

* –û—Å–Ω–æ–≤–Ω–∏–π –≤–∏–Ω—è—Ç–æ–∫ ‚Äî —Ç–æ–π, —â–æ –∑'—è–≤–∏–≤—Å—è **–ø–µ—Ä—à–∏–º** (—Ç–æ–±—Ç–æ —É **–æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ —Ä–µ—Å—É—Ä—Å—É**).
* –Ü–Ω—à—ñ ‚Äî **–ø—Ä–∏–≥–ª—É—à–µ–Ω—ñ (suppressed)** —ñ –¥–æ—Å—Ç—É–ø–Ω—ñ —á–µ—Ä–µ–∑ **`Throwable.getSuppressed()`**.

#### **‚úîÔ∏è –ü—Ä–∏–∫–ª–∞–¥:**

```java
try (
    TestResource r1 = new TestResource("R1");
    TestResource r2 = new TestResource("R2") // –∫–∏–¥–∞—î –≤–∏–Ω—è—Ç–æ–∫ —É close()
) {
    System.out.println("–†–æ–±–æ—Ç–∞ –∑ —Ä–µ—Å—É—Ä—Å–∞–º–∏");
} catch (Exception e) {
    System.out.println("–û—Å–Ω–æ–≤–Ω–∞ –ø–æ–º–∏–ª–∫–∞: " + e.getMessage());
    for (Throwable suppressed : e.getSuppressed()) {
        System.out.println("–ü—Ä–∏–¥—É—à–µ–Ω–æ: " + suppressed.getMessage());
    }
}
```

üì¶ –£ —Ü—å–æ–º—É –ø—Ä–∏–∫–ª–∞–¥—ñ, —è–∫—â–æ **`r2.close()`** —ñ **`r1.close()`** –æ–±–∏–¥–≤–∞ –∫–∏–¥–∞—é—Ç—å –≤–∏–Ω—è—Ç–∫–∏ ‚Äî **`r2`** –±—É–¥–µ –æ—Å–Ω–æ–≤–Ω–æ—é, –∞ **`r1`** –ø—Ä–∏–≥–ª—É—à–µ–Ω–æ—é.

---

## **üß† –ú–Ω–µ–º–æ–Ω—ñ–∫–∞ –¥–ª—è –∑–∞–ø–∞–º‚Äô—è—Ç–æ–≤—É–≤–∞–Ω–Ω—è:**

```java
TWR: üîìüîìüîì -> üîíüîíüîí
(–≤—ñ–¥–∫—Ä–∏–ª–∏—Å—å –∑–≤–µ—Ä—Ö—É -- –∑–∞–∫—Ä–∏–ª–∏—Å—å –∑–Ω–∏–∑—É)
```

–ê–±–æ:

```java
TWR –∑ –∫—ñ–ª—å–∫–æ–º–∞ —Ä–µ—Å—É—Ä—Å–∞–º–∏ -> —Å—Ç–µ–∫: –∑–∞–∫—Ä–∏–≤–∞—é—Ç—å—Å—è –≤ –∑–≤–æ—Ä–æ—Ç–Ω–æ–º—É –ø–æ—Ä—è–¥–∫—É
```

---

## **üü© –ü—ñ–¥—Å—É–º–æ–∫:**

* –£ **`try-with-resources`** –º–æ–∂–Ω–∞ –≤—ñ–¥–∫—Ä–∏–≤–∞—Ç–∏ **–∫—ñ–ª—å–∫–∞ —Ä–µ—Å—É—Ä—Å—ñ–≤ –æ–¥–Ω–æ—á–∞—Å–Ω–æ** —á–µ—Ä–µ–∑ **`;`**.
* Java **–∑–∞–∫—Ä–∏–≤–∞—î —Ä–µ—Å—É—Ä—Å–∏ —É –∑–≤–æ—Ä–æ—Ç–Ω–æ–º—É –ø–æ—Ä—è–¥–∫—É**, –≤ —è–∫–æ–º—É –≤–æ–Ω–∏ –±—É–ª–∏ –≤—ñ–¥–∫—Ä–∏—Ç—ñ.
* –ü—Ä–∏ –≤–∏–Ω—è—Ç–∫–∞—Ö —É **`close()`**:
  * **–û—Å–Ω–æ–≤–Ω–∏–π** –≤–∏–Ω—è—Ç–æ–∫ ‚Äî –≤—ñ–¥ –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ —Ä–µ—Å—É—Ä—Å—É.
  * **–Ü–Ω—à—ñ** ‚Äî –ø—Ä–∏–≥–ª—É—à–µ–Ω—ñ, –¥–æ—Å—Ç—É–ø–Ω—ñ —á–µ—Ä–µ–∑ **`getSuppressed()`**.
* –Ü–¥–µ–∞–ª—å–Ω–æ –ø—ñ–¥—Ö–æ–¥–∏—Ç—å –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ –æ–±–≥–æ—Ä—Ç–∫–∞–º–∏ –ø–æ—Ç–æ–∫—ñ–≤, –¥–µ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å –∑–∞–∫—Ä–∏—Ç—Ç—è –º–∞—î –∑–Ω–∞—á–µ–Ω–Ω—è.
