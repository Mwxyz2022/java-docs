---
layout: default
title: "Thread-safe –∫–æ–ª–µ–∫—Ü—ñ—ó"
parent: "–ö–æ–ª–µ–∫—Ü—ñ—ó: ArrayList —Ç–∞ LinkedList"
grand_parent: "Java Core"
nav_order: 13
---

# Thread-safe –∫–æ–ª–µ–∫—Ü—ñ—ó

* –∫–æ—Ä–æ—Ç–∫–∏–π –æ–ø–∏—Å: `Thread-safe` –∫–æ–ª–µ–∫—Ü—ñ—ó ‚Äì —Ü–µ –∫–æ–ª–µ–∫—Ü—ñ—ó, —è–∫—ñ –º–æ–∂—É—Ç—å –±–µ–∑–ø–µ—á–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏—Å—è –∫—ñ–ª—å–∫–æ–º–∞ –ø–æ—Ç–æ–∫–∞–º–∏ –æ–¥–Ω–æ—á–∞—Å–Ω–æ –±–µ–∑ –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó, –æ—Å–∫—ñ–ª—å–∫–∏ –≤–æ–Ω–∏ —Å–∞–º—ñ –¥–±–∞—é—Ç—å –ø—Ä–æ –≤–Ω—É—Ç—Ä—ñ—à–Ω—î –±–ª–æ–∫—É–≤–∞–Ω–Ω—è –∞–±–æ –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è.

* –ø–æ–Ω—è—Ç—Ç—è: `Thread-safe`, `concurrency`, `ConcurrentHashMap`, `CopyOnWriteArrayList`, `BlockingQueue`.

* –ø—Ä–∏–∫–ª–∞–¥–∏: –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è `ConcurrentHashMap` –¥–ª—è –ø–æ—Ç–æ–∫–æ–±–µ–∑–ø–µ—á–Ω–∏—Ö –º–∞–ø, `CopyOnWriteArrayList` –¥–ª—è —Å–ø–∏—Å–∫—ñ–≤, –¥–µ —á–∞—Å—Ç—ñ —á–∏—Ç–∞–Ω–Ω—è —ñ —Ä—ñ–¥–∫—ñ –∑–º—ñ–Ω–∏.

* –∫–ª—é—á–æ–≤—ñ –º–æ–º–µ–Ω—Ç–∏: –ù–µ–æ–±—Ö—ñ–¥–Ω—ñ –≤ –±–∞–≥–∞—Ç–æ–ø–æ—Ç–æ–∫–æ–≤–∏—Ö –∑–∞—Å—Ç–æ—Å—É–Ω–∫–∞—Ö. –í–∏–±—ñ—Ä –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ —Å—Ü–µ–Ω–∞—Ä—ñ—é –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è (–±–∞–≥–∞—Ç–æ —á–∏—Ç–∞–Ω—å/–∑–∞–ø–∏—Å—ñ–≤).

* —â–æ –≤–∞–∂–ª–∏–≤–æ –∑–Ω–∞—Ç–∏ –Ω–∞ —Å–ø—ñ–≤–±–µ—Å—ñ–¥—ñ: –ö–æ–ª–∏ –ø–æ—Ç—Ä—ñ–±–Ω—ñ, –æ—Å–Ω–æ–≤–Ω—ñ `thread-safe` –∫–æ–ª–µ–∫—Ü—ñ—ó.

### **‚úÖ –û—Ñ—ñ—Ü—ñ–π–Ω–µ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è:**

**`Thread-safe –∫–æ–ª–µ–∫—Ü—ñ—ó`** ‚Äî —Ü–µ –∫–æ–ª–µ–∫—Ü—ñ—ó, —è–∫—ñ –º–æ–∂—É—Ç—å –±–µ–∑–ø–µ—á–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏—Å—å –∫—ñ–ª—å–∫–æ–º–∞ –ø–æ—Ç–æ–∫–∞–º–∏ –æ–¥–Ω–æ—á–∞—Å–Ω–æ –±–µ–∑ –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó.

### **üß† –ü—Ä–æ—Å—Ç–∏–º–∏ —Å–ª–æ–≤–∞–º–∏:**

–¶–µ –∫–æ–ª–µ–∫—Ü—ñ—ó, —è–∫—ñ –Ω–µ —Ä–æ–∑–≤–∞–ª—è—Ç—å—Å—è, —è–∫—â–æ –¥–æ –Ω–∏—Ö –∑–≤–µ—Ä—Ç–∞—Ç–∏–º—É—Ç—å—Å—è –æ–¥–Ω–æ—á–∞—Å–Ω–æ –∑ —Ä—ñ–∑–Ω–∏—Ö –ø–æ—Ç–æ–∫—ñ–≤. –í–æ–Ω–∏ —Å–∞–º—ñ –¥–±–∞—é—Ç—å –ø—Ä–æ –±–ª–æ–∫—É–≤–∞–Ω–Ω—è, –∫–æ–ø—ñ—ó —á–∏ –∞—Ç–æ–º–∞—Ä–Ω—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó, —â–æ–± —É–Ω–∏–∫–Ω—É—Ç–∏ "–ø–æ—Ç–æ–∫–æ–≤–æ–≥–æ —Ö–∞–æ—Å—É".

---

## **üìä –ù–∞–π–ø–æ—à–∏—Ä–µ–Ω—ñ—à—ñ thread-safe –∫–æ–ª–µ–∫—Ü—ñ—ó:**

| –ö–æ–ª–µ–∫—Ü—ñ—è | –¢–∏–ø | –ú–µ—Ö–∞–Ω—ñ–∑–º –±–µ–∑–ø–µ–∫–∏ | –ü—ñ–¥—Ö–æ–¥–∏—Ç—å –¥–ª—è |
| :---: | :---: | ----- | ----- |
| **`ConcurrentHashMap`** | **`Map`** | –°–µ–≥–º–µ–Ω—Ç–æ–≤–∞–Ω–∞ –±–ª–æ–∫—É–≤–∞–Ω–Ω—è, CAS | –ß–∞—Å—Ç—ñ —á–∏—Ç–∞–Ω–Ω—è —Ç–∞ –∑–∞–ø–∏—Å–∏ |
| **`CopyOnWriteArrayList`** | **`List`** | –ö–æ–ø—ñ—é–≤–∞–Ω–Ω—è –Ω–∞ –∑–∞–ø–∏—Å | –ß–∞—Å—Ç—ñ —á–∏—Ç–∞–Ω–Ω—è, —Ä—ñ–¥–∫—ñ –∑–º—ñ–Ω–∏ |
| **`ConcurrentLinkedQueue`** | **`Queue`** | –ù–µ–±–ª–æ–∫—É—é—á—ñ –∞–ª–≥–æ—Ä–∏—Ç–º–∏ (lock-free) | –í–∏—Å–æ–∫–∞ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü—ñ—è –º—ñ–∂ –ø–æ—Ç–æ–∫–∞–º–∏ |
| **`BlockingQueue`** | **`Queue`** | –ë–ª–æ–∫—É–≤–∞–Ω–Ω—è –∑ –æ—á—ñ–∫—É–≤–∞–Ω–Ω—è–º (**`take/put`**) | –û—á—ñ–∫—É–≤–∞–Ω–Ω—è –º—ñ–∂ –ø–æ—Ç–æ–∫–∞–º–∏ |
| **`SynchronizedList`** | –û–±–≥–æ—Ä—Ç–∫–∞ –¥–ª—è **`List`** | **`Collections.synchronizedList(list)`** | –ü—Ä–æ—Å—Ç–µ —Ä—ñ—à–µ–Ω–Ω—è, –±–∞–∑–æ–≤–∞ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—è |

---

## **–ü–æ—è—Å–Ω–µ–Ω–Ω—è –Ω–∞ –ø–∞–ª—å—Ü—è—Ö (üí°)**

–£—è–≤–∏ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–Ω—É –∫—É—Ö–Ω—é:

* **`ArrayList`** ‚Äî —É—Å—ñ –∫—É—Ö–∞—Ä—ñ —Ä—ñ–∂—É—Ç—å –æ–≤–æ—á—ñ –∑ –æ–¥–Ω—ñ—î—ó –¥–æ—à–∫–∏. –•–∞–æ—Å. ü•¥
* **`CopyOnWriteArrayList`** ‚Äî –∫–æ–∂–Ω–æ–º—É –∫—É—Ö–∞—Ä—é –≤–∏–¥–∞—î—Ç—å—Å—è –∫–æ–ø—ñ—è –¥–æ—à–∫–∏, –∞–ª–µ —Ü–µ –ø–æ–≤—ñ–ª—å–Ω—ñ—à–µ. üßë‚Äçüç≥üìÑ
* **`ConcurrentHashMap`** ‚Äî –∫–æ–∂–µ–Ω –∫—É—Ö–∞—Ä –º–∞—î –¥–æ—Å—Ç—É–ø –¥–æ —Å–≤–æ—î—ó –∑–æ–Ω–∏ —Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫–∞. –†–æ–∑–¥—ñ–ª–µ–Ω–æ —Ç–∞ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ. ‚ùÑÔ∏èü•ï

---

## **–ö–æ—Ä–∏—Å–Ω—ñ –ø—Ä–∏–∫–ª–∞–¥–∏ (üß™)**

### **‚ùå –ù–µ–±–µ–∑–ø–µ–∫–∞ –∑–≤–∏—á–∞–π–Ω–æ—ó –∫–æ–ª–µ–∫—Ü—ñ—ó:**

```java
List<String> list = new ArrayList<>();

Runnable writer = () -> list.add(Thread.currentThread().getName());
Thread t1 = new Thread(writer);
Thread t2 = new Thread(writer);

t1.start(); t2.start(); // üí• –ú–æ–∂–µ —Å—Ç–∞—Ç–∏—Å—è race condition
```

### **‚úÖ Thread-safe –≤–∞—Ä—ñ–∞–Ω—Ç:**

```java
List<String> list = new CopyOnWriteArrayList<>();

Runnable writer = () -> list.add(Thread.currentThread().getName());
new Thread(writer).start();
new Thread(writer).start(); // üëç –ë–µ–∑–ø–µ—á–Ω–µ –¥–æ–¥–∞–≤–∞–Ω–Ω—è
```

### **–ü—Ä–∏–∫–ª–∞–¥ –∑ `ConcurrentHashMap`:**

```java
Map<String, Integer> map = new ConcurrentHashMap<>();

Runnable updater = () -> map.put(Thread.currentThread().getName(), 1);
new Thread(updater).start();
new Thread(updater).start(); // üß† –ë–µ–∑ –±–ª–æ–∫—É–≤–∞–Ω—å, –ø—Ä–∞—Ü—é—î –ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ
```

---

## **–ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è (‚öñÔ∏è)**

| –û—Å–æ–±–ª–∏–≤—ñ—Å—Ç—å | `ArrayList` / `HashMap` | `CopyOnWriteArrayList` | `ConcurrentHashMap` |
| :---: | :---: | :---: | :---: |
| **Thread-safe** | ‚ùå | ‚úÖ | ‚úÖ |
| **–ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –Ω–∞ –∑–∞–ø–∏—Å** | üîº (—à–≤–∏–¥–∫–æ) | üîΩ (–ø–æ–≤—ñ–ª—å–Ω–æ) | ‚öñÔ∏è (–∑–±–∞–ª–∞–Ω—Å–æ–≤–∞–Ω–æ) |
| **–ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –Ω–∞ —á–∏—Ç–∞–Ω–Ω—è** | üîº | üîº | üîº |
| **–ü—ñ–¥—Ö–æ–¥–∏—Ç—å –¥–ª—è** | –û–¥–Ω–æ–ø–æ—Ç–æ—á–Ω–∏—Ö –∑–∞–¥–∞—á | –ë–∞–≥–∞—Ç–æ—á–∏—Ç–∞–ª—å–Ω–∏—Ö –∑–∞–¥–∞—á | –í–∏—Å–æ–∫–æ–Ω–≤–∞–Ω–∫—É—Ä–µ–Ω—Ç–Ω–∏—Ö |

---

## **FAQ ‚Äî –ß–∞—Å—Ç—ñ –∑–∞–ø–∏—Ç–∞–Ω–Ω—è (‚ùì)**

### **‚ùì –ü–∏—Ç–∞–Ω–Ω—è:**

–ö–æ–ª–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **`CopyOnWriteArrayList`**?

### **üí¨ –í—ñ–¥–ø–æ–≤—ñ–¥—å:**

–ö–æ–ª–∏ —É –≤–∞—Å **–¥—É–∂–µ –±–∞–≥–∞—Ç–æ —á–∏—Ç–∞–Ω–Ω—è —ñ —Ä—ñ–¥–∫—ñ—Å–Ω—ñ –∑–º—ñ–Ω–∏** ‚Äî –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π–Ω—ñ —Å–ø–∏—Å–∫–∏, —è–∫—ñ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—é—Ç—å—Å—è –ø—ñ–¥ —á–∞—Å –∑–∞–ø—É—Å–∫—É, –∞ –ø–æ—Ç—ñ–º –º–∞–π–∂–µ –Ω–µ –∑–º—ñ–Ω—é—é—Ç—å—Å—è.

####

### **‚ùì –ü–∏—Ç–∞–Ω–Ω—è:**

–£ —á–æ–º—É –≤—ñ–¥–º—ñ–Ω–Ω—ñ—Å—Ç—å –º—ñ–∂ **`ConcurrentHashMap`** —ñ **`Collections`**`.synchronizedMap()`?

### **üí¨ –í—ñ–¥–ø–æ–≤—ñ–¥—å:**

* **`synchronizedMap()`** —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑—É—î –≤—Å—ñ –º–µ—Ç–æ–¥–∏, —â–æ –∑–Ω–∏–∂—É—î –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å.
* **`ConcurrentHashMap`** –¥–æ–∑–≤–æ–ª—è—î –∫—ñ–ª—å–∫–æ–º –ø–æ—Ç–æ–∫–∞–º –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –∑ —Ä—ñ–∑–Ω–∏–º–∏ —Å–µ–≥–º–µ–Ω—Ç–∞–º–∏ –º–∞–ø–∏ –æ–¥–Ω–æ—á–∞—Å–Ω–æ, —â–æ –∑–Ω–∞—á–Ω–æ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—à–µ.

####

### **‚ùì –ü–∏—Ç–∞–Ω–Ω—è:**

–ß–∏ –≤—Å—ñ –º–µ—Ç–æ–¥–∏ **`CopyOnWriteArrayList`** –±–µ–∑–ø–µ—á–Ω—ñ?

### **üí¨ –í—ñ–¥–ø–æ–≤—ñ–¥—å:**

–¢–∞–∫, —É—Å—ñ –º–µ—Ç–æ–¥–∏ —î –ø–æ—Ç–æ–∫–æ–±–µ–∑–ø–µ—á–Ω–∏–º–∏. –ê–ª–µ –ø–∞–º'—è—Ç–∞–π, —â–æ **–Ω–∞ –∫–æ–∂–Ω—É –∑–º—ñ–Ω—É —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –∫–æ–ø—ñ—è**, —â–æ –º–æ–∂–µ –±—É—Ç–∏ –¥–æ—Ä–æ–≥–∏–º —É –≤–µ–ª–∏–∫–∏—Ö —Å–ø–∏—Å–∫–∞—Ö.

---

## **üß† –ú–Ω–µ–º–æ–Ω—ñ–∫–∞ –¥–ª—è –∑–∞–ø–∞–º‚Äô—è—Ç–æ–≤—É–≤–∞–Ω–Ω—è:**

**"CopyOnWrite ‚Äî —á–∏—Ç–∞–π —Ö–æ—á —Å—Ç–æ —Ä–∞–∑, –∑–º—ñ–Ω—é–π ‚Äî –∫–æ–ø—ñ—è\!"**

**"Concurrent ‚Äî –ø—Ä–∞—Ü—é—î —Ä–∞–∑–æ–º, –Ω–µ –±‚Äô—î—Ç—å—Å—è –Ω—ñ—Ö—Ç–æ\!"**
---

## **üü© –ü—ñ–¥—Å—É–º–æ–∫:**

* Thread-safe –∫–æ–ª–µ–∫—Ü—ñ—ó —Ä—è—Ç—É—é—Ç—å —É –±–∞–≥–∞—Ç–æ–ø–æ—Ç–æ—á–Ω–∏—Ö –∑–∞—Å—Ç–æ—Å—É–Ω–∫–∞—Ö.
* –û–±–∏—Ä–∞–π —Ç–∏–ø –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ –±–∞–ª–∞–Ω—Å—É **–∑–∞–ø–∏—Å/—á–∏—Ç–∞–Ω–Ω—è**.
* –ù–µ –∑–∞–≤–∂–¥–∏ –≤–∞—Ä—Ç–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ thread-safe ‚Äî —É –æ–¥–Ω–æ–ø–æ—Ç–æ—á–Ω–æ–º—É —Å–µ—Ä–µ–¥–æ–≤–∏—â—ñ —Ü–µ –ª–∏—à–µ –Ω–∞–∫–ª–∞–¥–Ω—ñ –≤–∏—Ç—Ä–∞—Ç–∏.
* –ù–∞–π–±—ñ–ª—å—à –ø—Ä–∞–∫—Ç–∏—á–Ω—ñ: **`ConcurrentHashMap`**, **`CopyOnWriteArrayList`**, **`BlockingQueue`**.

üîó –ö–æ—Ä–∏—Å–Ω—ñ –ø–æ—Å–∏–ª–∞–Ω–Ω—è:

* [Java Docs ‚Äî ConcurrentHashMap](https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ConcurrentHashMap.html)
